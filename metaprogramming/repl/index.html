<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>REPL</title> <meta name="generator" content="Jekyll v4.2.1" /> <meta property="og:title" content="REPL" /> <meta name="author" content="Kamil Figiela" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Napkin tutorials for data scientists and analytics using BigQuery, Postgres, Sqlite and other NoSql/SQL systems." /> <meta property="og:description" content="Napkin tutorials for data scientists and analytics using BigQuery, Postgres, Sqlite and other NoSql/SQL systems." /> <link rel="canonical" href="https://soostone.github.io/metaprogramming/repl/" /> <meta property="og:url" content="https://soostone.github.io/metaprogramming/repl/" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="REPL" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Kamil Figiela"},"url":"https://soostone.github.io/metaprogramming/repl/","@type":"WebPage","description":"Napkin tutorials for data scientists and analytics using BigQuery, Postgres, Sqlite and other NoSql/SQL systems.","headline":"REPL","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> <script src="https://code.jquery.com/jquery-3.6.0.slim.min.js" integrity="sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI=" crossorigin="anonymous"></script> <script type="text/javascript" src="/assets/js/resize.js"></script> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewbox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewbox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewbox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewbox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewbox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="#" id="menu-button" class="site-button"> <svg viewbox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list">
<li class="nav-list-item"><a href="https://soostone.github.io/" class="nav-list-link">About</a></li>
<li class="nav-list-item"><a href="https://soostone.github.io/getting-started/" class="nav-list-link">Getting started</a></li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://soostone.github.io/install/" class="nav-list-link">Installation</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://soostone.github.io/install#native" class="nav-list-link">Native</a></li>
<li class="nav-list-item "><a href="https://soostone.github.io/install#homebrew" class="nav-list-link">Homebrew</a></li>
<li class="nav-list-item "><a href="https://soostone.github.io/install#docker" class="nav-list-link">Docker</a></li>
<li class="nav-list-item "><a href="https://soostone.github.io/install#cachix" class="nav-list-link">Cachix</a></li>
</ul>
</li>
<li class="nav-list-item"><a href="https://soostone.github.io/fundamentals/" class="nav-list-link">Fundamentals</a></li>
<li class="nav-list-item"><a href="https://soostone.github.io/tips-and-tricks/" class="nav-list-link">Tips and Tricks</a></li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://soostone.github.io/user-manual/" class="nav-list-link">User Manual</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://soostone.github.io/user-manual/mustache/" class="nav-list-link">Mustache Interpolation</a></li>
<li class="nav-list-item "><a href="https://soostone.github.io/user-manual/yaml-reference/" class="nav-list-link">Spec YAML reference</a></li>
<li class="nav-list-item "><a href="https://soostone.github.io/user-manual/spec-arguments/" class="nav-list-link">Spec arguments</a></li>
<li class="nav-list-item "><a href="https://soostone.github.io/user-manual/db-connection/" class="nav-list-link">Connecting to the database</a></li>
<li class="nav-list-item "><a href="https://soostone.github.io/user-manual/docker/" class="nav-list-link">Docker</a></li>
<li class="nav-list-item "><a href="https://soostone.github.io/user-manual/cli-reference/" class="nav-list-link">CLI reference</a></li>
<li class="nav-list-item "><a href="https://soostone.github.io/user-manual/multi-environment/" class="nav-list-link">Multi-environment pipelines in a team setting</a></li>
<li class="nav-list-item "><a href="https://soostone.github.io/user-manual/devcontainer/" class="nav-list-link">Devcontainer</a></li>
<li class="nav-list-item "><a href="https://soostone.github.io/user-manual/ide/" class="nav-list-link">IDE Support</a></li>
<li class="nav-list-item "><a href="https://soostone.github.io/user-manual/preprocessors/" class="nav-list-link">Preprocessors</a></li>
<li class="nav-list-item "><a href="https://soostone.github.io/user-manual/github-actions/" class="nav-list-link">Running as a scheduled job on GitHub Actions</a></li>
</ul>
</li>
<li class="nav-list-item active">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://soostone.github.io/metaprogramming/" class="nav-list-link">Metaprogramming</a><ul class="nav-list ">
<li class="nav-list-item active"><a href="https://soostone.github.io/metaprogramming/repl/" class="nav-list-link active">REPL</a></li>
<li class="nav-list-item "><a href="https://soostone.github.io/metaprogramming/custom-hooks/" class="nav-list-link">Writing Custom Hooks</a></li>
<li class="nav-list-item "><a href="https://soostone.github.io/metaprogramming/haskell/" class="nav-list-link">Haskell API</a></li>
</ul>
</li>
<li class="nav-list-item"><a href="https://soostone.github.io/haddock/" class="nav-list-link">API Reference</a></li>
<li class="nav-list-item"><a href="https://soostone.github.io/changelog/" class="nav-list-link">Changelog</a></li>
</ul> </nav> </div> <div class="site-super-header"> <div class="super-nav-box"> <div class="site-logo"></div> <div class="site-buttons"> <a class="link-button active" href="/">Documentation</a> <a class="link-button" href="https://napkinweb.webflow.io/community" target="_blank" rel="noopener noreferrer">Community</a> <a class="link-button" href="https://napkinweb.webflow.io/features" target="_blank" rel="noopener noreferrer">Features</a> <a class="link-button" href="https://napkinweb.webflow.io/usecases" target="_blank" rel="noopener noreferrer">Use Cases</a> <span class="gradient-border"> <a class="link-button" href="/install/">Install</a> </span> </div> </div> </div> <div class="width-ruler"></div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search " aria-label="Search " autocomplete="off"> <label for="search-input" class="search-label"><svg viewbox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="https://soostone.github.io/metaprogramming/">Metaprogramming</a></li> <li class="breadcrumb-nav-list-item"><span>REPL</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="repl">REPL</h1> <p><code class="language-plaintext highlighter-rouge">napkin repl</code> starts <a href="https://wiki.haskell.org/GHC/GHCi" target="_blank" rel="noopener noreferrer">GHCI</a> session that is preconfigured for Spec development. It can be used to run Spec and Hook programs interactively for easier debugging. In addition to configuring GHCI session with appropriate language extensions, search path and packages, Napkin will define helper macros that make running custom spec and hook programs easier.</p> <h2 id="runspecprogram">runSpecProgram</h2> <p><code class="language-plaintext highlighter-rouge">:runSpecProgram</code> macro can be used to run any <code class="language-plaintext highlighter-rouge">SpecProgram' backend returnValue</code> interactively. Note that programs used to create tables have a type of <code class="language-plaintext highlighter-rouge">SpecProgram backend</code> which forces return type to be <code class="language-plaintext highlighter-rouge">()</code>. However, for interactive runs, one may return any value. Returned value will be bound to <code class="language-plaintext highlighter-rouge">result</code> This macro accepts the target table name and the program as arguments.</p> <p class="text-delta text-center">napkin-repl</p> <div class="language-haskell copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">import</span> <span class="nn">SomeModule</span>
<span class="o">:</span><span class="n">runSpecProgram</span> <span class="s">"target.table.name"</span> <span class="kt">SomeModule</span><span class="o">.</span><span class="n">myProgram</span>
</code></pre></div></div> <p>Program can be inlined as well (make sure to use quotes or <code class="language-plaintext highlighter-rouge">$</code> operator)</p> <p class="text-delta text-center">napkin-repl</p> <div class="language-haskell copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">:</span><span class="n">runSpecProgram</span> <span class="s">"target.table.name"</span> <span class="p">(</span><span class="n">logInfo</span> <span class="s">"I am a spec program"</span> <span class="o">&gt;&gt;</span> <span class="n">pure</span> <span class="s">"some return value"</span><span class="p">)</span>
</code></pre></div></div> <p>or</p> <p class="text-delta text-center">napkin-repl</p> <div class="language-haskell copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">:</span><span class="n">runSpecProgram</span> <span class="s">"target.table.name"</span> <span class="o">$</span> <span class="n">logInfo</span> <span class="s">"I am a spec program"</span> <span class="o">&gt;&gt;</span> <span class="n">pure</span> <span class="s">"some return value"</span>
</code></pre></div></div> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">napkin</span><span class="o">-</span><span class="n">repl</span><span class="o">&gt;</span> <span class="o">:</span><span class="n">runSpecProgram</span> <span class="s">"target.table.name"</span> <span class="err">$</span> <span class="n">logInfo</span> <span class="s">"I am a spec program"</span> <span class="o">&gt;&gt;</span> <span class="n">pure</span> <span class="s">"some return value"</span>
<span class="o">[</span><span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">13</span> <span class="mi">11</span><span class="o">:</span><span class="mi">46</span><span class="o">:</span><span class="mi">31</span><span class="o">][</span><span class="nc">Info</span><span class="o">]</span> <span class="no">I</span> <span class="n">am</span> <span class="n">a</span> <span class="n">spec</span> <span class="n">program</span>
<span class="nc">Right</span> <span class="s">"some return value"</span>
<span class="n">napkin</span><span class="o">-</span><span class="n">repl</span><span class="o">&gt;</span> <span class="o">:</span><span class="n">type</span> <span class="n">result</span>
<span class="n">result</span>
  <span class="o">::</span> <span class="nc">Either</span>
       <span class="nc">Napkin</span><span class="o">.</span><span class="na">Run</span><span class="o">.</span><span class="na">Effects</span><span class="o">.</span><span class="na">Languages</span><span class="o">.</span><span class="na">NapkinError</span><span class="o">.</span><span class="na">NapkinEffectError</span> <span class="o">[</span><span class="nc">Char</span><span class="o">]</span>
<span class="n">napkin</span><span class="o">-</span><span class="n">repl</span><span class="o">&gt;</span> <span class="n">result</span>
<span class="nc">Right</span> <span class="s">"some return value"</span>
</code></pre></div></div> <h2 id="runhookprogram">runHookProgram</h2> <p><code class="language-plaintext highlighter-rouge">:runHookProgram</code> macro allows to run arbitrary <code class="language-plaintext highlighter-rouge">HookProgram' backend returnValue</code>. Similarly to <code class="language-plaintext highlighter-rouge">runSpecProgram</code>, REPL helper allows to return value.</p> <p class="text-delta text-center">napkin-repl</p> <div class="language-haskell copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">:</span><span class="n">runHookProgram</span> <span class="p">(</span><span class="n">logInfo</span> <span class="s">"I am a hook program"</span> <span class="o">&gt;&gt;</span> <span class="n">pure</span> <span class="mh">0x1234</span><span class="p">)</span>
</code></pre></div></div> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">napkin</span><span class="o">-</span><span class="n">repl</span><span class="o">&gt;</span> <span class="o">:</span><span class="n">runHookProgram</span> <span class="o">(</span><span class="n">logInfo</span> <span class="s">"I am a hook program"</span> <span class="o">&gt;&gt;</span> <span class="n">pure</span> <span class="mh">0x1234</span><span class="o">)</span>
<span class="o">[</span><span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">13</span> <span class="mi">11</span><span class="o">:</span><span class="mi">52</span><span class="o">:</span><span class="mi">14</span><span class="o">][</span><span class="nc">Info</span><span class="o">]</span> <span class="no">I</span> <span class="n">am</span> <span class="n">a</span> <span class="n">hook</span> <span class="n">program</span>
<span class="nf">Right</span> <span class="o">(</span><span class="nc">Right</span> <span class="o">([],</span><span class="mi">4660</span><span class="o">))</span>
<span class="n">napkin</span><span class="o">-</span><span class="n">repl</span><span class="o">&gt;</span> <span class="o">:</span><span class="n">type</span> <span class="n">result</span>
<span class="n">result</span>
  <span class="o">::</span> <span class="nc">Either</span>
       <span class="nc">Napkin</span><span class="o">.</span><span class="na">Run</span><span class="o">.</span><span class="na">Effects</span><span class="o">.</span><span class="na">Languages</span><span class="o">.</span><span class="na">NapkinError</span><span class="o">.</span><span class="na">NapkinEffectError</span>
       <span class="o">(</span><span class="nc">Either</span>
          <span class="o">(</span><span class="no">GHC</span><span class="o">.</span><span class="na">Base</span><span class="o">.</span><span class="na">NonEmpty</span>
             <span class="nc">Napkin</span><span class="o">.</span><span class="na">Run</span><span class="o">.</span><span class="na">Effects</span><span class="o">.</span><span class="na">Languages</span><span class="o">.</span><span class="na">Assertion</span><span class="o">.</span><span class="na">AssertionEntry</span><span class="o">)</span>
          <span class="o">([</span><span class="nc">Napkin</span><span class="o">.</span><span class="na">Run</span><span class="o">.</span><span class="na">Effects</span><span class="o">.</span><span class="na">Languages</span><span class="o">.</span><span class="na">Assertion</span><span class="o">.</span><span class="na">AssertionEntry</span><span class="o">],</span> <span class="nc">Integer</span><span class="o">))</span>
<span class="n">napkin</span><span class="o">-</span><span class="n">repl</span><span class="o">&gt;</span> <span class="n">result</span>
<span class="nf">Right</span> <span class="o">(</span><span class="nc">Right</span> <span class="o">([],</span><span class="mi">4660</span><span class="o">))</span>
</code></pre></div></div> <h2 id="runcustomspec-and-runcustomhook">runCustomSpec and runCustomHook</h2> <p><code class="language-plaintext highlighter-rouge">:runCustomSpec</code> and <code class="language-plaintext highlighter-rouge">:runCustomHook</code> macros allow to run <code class="language-plaintext highlighter-rouge">SpecProgramWithArgParser</code> and <code class="language-plaintext highlighter-rouge">HookProgramWithArgParser</code> respectively:</p> <ul> <li>
<code class="language-plaintext highlighter-rouge">:runCustomSpec</code> accepts <code class="language-plaintext highlighter-rouge">SpecProgramWithArgParser backend</code>, target table name, and a <code class="language-plaintext highlighter-rouge">Map Text Aeson.Value</code> as arguments.</li> <li>
<code class="language-plaintext highlighter-rouge">:runCustomHook</code> accepts <code class="language-plaintext highlighter-rouge">HookProgramWithArgParser backend</code>, target table name, and a <code class="language-plaintext highlighter-rouge">Map Text Aeson.Value</code> as arguments.</li> </ul> <p class="text-delta text-center">napkin-repl</p> <div class="language-haskell copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">:</span><span class="n">runCustomSpec</span> <span class="n">customSpec</span> <span class="s">"target.table.name"</span> <span class="p">[(</span><span class="s">"arg"</span><span class="p">,</span> <span class="kt">A</span><span class="o">.</span><span class="kt">String</span> <span class="s">"foo"</span><span class="p">)]</span>
</code></pre></div></div> <p class="text-delta text-center">napkin-repl</p> <div class="language-haskell copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">:</span><span class="n">runCustomHook</span> <span class="n">customHook</span> <span class="p">[(</span><span class="s">"arg"</span><span class="p">,</span> <span class="kt">A</span><span class="o">.</span><span class="kt">String</span> <span class="s">"foo"</span><span class="p">)]</span>
</code></pre></div></div> <div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">:</span><span class="p">{</span>
 <span class="kr">let</span> <span class="n">customHook</span> <span class="o">::</span> <span class="kt">HookProgramWithArgParser</span> <span class="n">b</span>
     <span class="n">customHook</span> <span class="o">=</span> <span class="kt">HookProgramWithArgParser</span> <span class="o">$</span> <span class="nf">\</span><span class="n">obj</span> <span class="o">-&gt;</span> <span class="kr">do</span>
        <span class="n">arg</span> <span class="o">&lt;-</span> <span class="n">obj</span> <span class="o">.:</span> <span class="s">"arg"</span>
        <span class="n">pure</span> <span class="o">$</span> <span class="kr">do</span>
          <span class="n">logInfo</span> <span class="o">$</span> <span class="s">"The arg was: "</span> <span class="o">&lt;&gt;</span> <span class="n">arg</span>
<span class="o">:</span><span class="p">}</span>
</code></pre></div></div> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">napkin</span><span class="o">-</span><span class="n">repl</span><span class="o">&gt;</span> <span class="o">:</span><span class="n">runCustomHook</span> <span class="n">customHook</span> <span class="o">[(</span><span class="s">"arg"</span> <span class="o">.=</span> <span class="s">"Hello world!"</span><span class="o">)]</span>
<span class="o">[</span><span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">13</span> <span class="mi">12</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">25</span><span class="o">][</span><span class="nc">Info</span><span class="o">]</span> <span class="nc">The</span> <span class="n">arg</span> <span class="nl">was:</span> <span class="nc">Hello</span> <span class="n">world</span><span class="o">!</span>
<span class="nc">Right</span> <span class="o">(</span><span class="nc">Right</span> <span class="o">([],()))</span>
</code></pre></div></div> <h2 id="example">Example</h2> <p>We can define a <code class="language-plaintext highlighter-rouge">HookProgram</code> with corresponding argument parser and test it directly from the REPL. For production use, we’d define them in a Haskell module and import them to REPL or reference in the Spec.</p> <div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">:</span><span class="p">{</span>
 <span class="kr">let</span> <span class="n">checkManyTablesExistHook</span> <span class="o">::</span> <span class="p">[</span><span class="kt">Ref</span> <span class="kt">Table</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="kt">HookProgram</span> <span class="n">b</span>
     <span class="n">checkManyTablesExistHook</span> <span class="o">=</span> <span class="n">mapM_</span> <span class="o">$</span> <span class="nf">\</span><span class="n">table</span> <span class="o">-&gt;</span> <span class="kr">do</span>
        <span class="n">exists</span> <span class="o">&lt;-</span> <span class="n">checkTableExists</span> <span class="n">table</span>
        <span class="n">assertTrue</span> <span class="p">(</span><span class="s">"check if table "</span> <span class="o">&lt;&gt;</span> <span class="n">refText</span> <span class="n">table</span> <span class="o">&lt;&gt;</span> <span class="s">" exists"</span><span class="p">)</span> <span class="n">exists</span>
     <span class="n">customHookWithArgs</span> <span class="o">::</span> <span class="kt">HookProgramWithArgParser</span> <span class="n">b</span>
     <span class="n">customHookWithArgs</span> <span class="o">=</span> <span class="kt">HookProgramWithArgParser</span> <span class="o">$</span> <span class="nf">\</span><span class="n">obj</span> <span class="o">-&gt;</span> <span class="kr">do</span>
        <span class="n">tables</span> <span class="o">&lt;-</span> <span class="n">obj</span> <span class="o">.:</span> <span class="s">"tables"</span>
        <span class="n">pure</span> <span class="o">$</span> <span class="n">checkManyTablesExistHook</span> <span class="n">tables</span>
<span class="o">:</span><span class="p">}</span>

<span class="o">:</span><span class="n">runCustomHook</span> <span class="n">customHookWithArgs</span> <span class="p">[(</span><span class="s">"tables"</span> <span class="o">.=</span> <span class="p">[</span><span class="s">"chinook.Artist"</span><span class="p">,</span> <span class="s">"does_not.exist"</span><span class="p">])]</span>
</code></pre></div></div> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">napkin</span><span class="o">-</span><span class="n">repl</span><span class="o">&gt;</span> <span class="o">:</span><span class="n">runCustomHook</span> <span class="n">customHookWithArgs</span> <span class="o">[(</span><span class="s">"tables"</span> <span class="o">.=</span> <span class="o">[</span><span class="s">"chinook.Artist"</span><span class="o">,</span> <span class="s">"does_not.exist"</span><span class="o">])]</span>
<span class="o">...</span> <span class="n">some</span> <span class="n">logs</span> <span class="n">omited</span> <span class="k">for</span> <span class="n">brevity</span> <span class="o">...</span>
<span class="o">[</span><span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">13</span> <span class="mi">12</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mo">03</span><span class="o">][</span><span class="nc">Debug</span><span class="o">]</span> <span class="nc">Executing</span> <span class="nl">query:</span> <span class="no">SELECT</span>
    <span class="nf">exists</span><span class="o">((</span><span class="no">SELECT</span> <span class="mi">1</span> <span class="no">AS</span> <span class="s">"aaac"</span>
            <span class="no">FROM</span> <span class="s">"pg_catalog"</span><span class="o">.</span><span class="s">"pg_class"</span> <span class="no">AS</span> <span class="s">"aaaa"</span>
            <span class="no">INNER</span> <span class="no">JOIN</span> <span class="s">"pg_catalog"</span><span class="o">.</span><span class="s">"pg_namespace"</span> <span class="no">AS</span> <span class="s">"aaab"</span> <span class="no">ON</span> <span class="o">(</span><span class="s">"aaab"</span><span class="o">.</span><span class="s">"oid"</span> <span class="o">=</span> <span class="s">"aaaa"</span><span class="o">.</span><span class="s">"relnamespace"</span><span class="o">)</span>
            <span class="no">WHERE</span> <span class="o">((</span><span class="s">"aaab"</span><span class="o">.</span><span class="s">"nspname"</span> <span class="o">=</span> <span class="err">'</span><span class="n">chinook</span><span class="err">'</span><span class="o">))</span> <span class="n">and</span> <span class="o">((</span><span class="s">"aaaa"</span><span class="o">.</span><span class="s">"relname"</span> <span class="o">=</span> <span class="err">'</span><span class="nc">Artist</span><span class="err">'</span><span class="o">))))</span> <span class="no">AS</span> <span class="s">"check"</span>
<span class="o">[</span><span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">13</span> <span class="mi">12</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mo">03</span><span class="o">][</span><span class="nc">Debug</span><span class="o">]</span> <span class="n">table</span> <span class="n">chinook</span><span class="o">.</span><span class="na">Artist</span> <span class="n">exists</span>
<span class="o">[</span><span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">13</span> <span class="mi">12</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mo">03</span><span class="o">][</span><span class="nc">Debug</span><span class="o">]</span> <span class="nc">Executing</span> <span class="nl">query:</span> <span class="no">SELECT</span>
    <span class="nf">exists</span><span class="o">((</span><span class="no">SELECT</span> <span class="mi">1</span> <span class="no">AS</span> <span class="s">"aaac"</span>
            <span class="no">FROM</span> <span class="s">"pg_catalog"</span><span class="o">.</span><span class="s">"pg_class"</span> <span class="no">AS</span> <span class="s">"aaaa"</span>
            <span class="no">INNER</span> <span class="no">JOIN</span> <span class="s">"pg_catalog"</span><span class="o">.</span><span class="s">"pg_namespace"</span> <span class="no">AS</span> <span class="s">"aaab"</span> <span class="no">ON</span> <span class="o">(</span><span class="s">"aaab"</span><span class="o">.</span><span class="s">"oid"</span> <span class="o">=</span> <span class="s">"aaaa"</span><span class="o">.</span><span class="s">"relnamespace"</span><span class="o">)</span>
            <span class="no">WHERE</span> <span class="o">((</span><span class="s">"aaab"</span><span class="o">.</span><span class="s">"nspname"</span> <span class="o">=</span> <span class="err">'</span><span class="n">does_not</span><span class="err">'</span><span class="o">))</span> <span class="n">and</span> <span class="o">((</span><span class="s">"aaaa"</span><span class="o">.</span><span class="s">"relname"</span> <span class="o">=</span> <span class="err">'</span><span class="n">exist</span><span class="err">'</span><span class="o">))))</span> <span class="no">AS</span> <span class="s">"check"</span>
<span class="o">[</span><span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">13</span> <span class="mi">12</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mo">03</span><span class="o">][</span><span class="nc">Error</span><span class="o">]</span> <span class="n">table</span> <span class="n">does_not</span><span class="o">.</span><span class="na">exist</span> <span class="n">exists</span>
<span class="nf">Right</span> <span class="o">(</span><span class="nc">Left</span> <span class="o">(</span><span class="nc">AssertionEntry</span> <span class="o">{</span><span class="n">assertionGroup</span> <span class="o">=</span> <span class="nc">AssertionGroup</span> <span class="o">[],</span> <span class="n">assertionMessage</span> <span class="o">=</span> <span class="s">"table chinook.Artist exists"</span><span class="o">,</span> <span class="n">assertionStatus</span> <span class="o">=</span> <span class="nc">Success</span><span class="o">,</span> <span class="n">assertionSeverity</span> <span class="o">=</span> <span class="nc">FailNow</span><span class="o">}</span> <span class="o">:|</span> <span class="o">[</span><span class="nc">AssertionEntry</span> <span class="o">{</span><span class="n">assertionGroup</span> <span class="o">=</span> <span class="nc">AssertionGroup</span> <span class="o">[],</span> <span class="n">assertionMessage</span> <span class="o">=</span> <span class="s">"table does_not.exist exists"</span><span class="o">,</span> <span class="n">assertionStatus</span> <span class="o">=</span> <span class="nc">Failure</span> <span class="nc">Nothing</span><span class="o">,</span> <span class="n">assertionSeverity</span> <span class="o">=</span> <span class="nc">FailNow</span><span class="o">}]))</span>
<span class="o">...</span>
</code></pre></div></div> </div> </div> <div class="search-overlay"></div> </div> <div class="site-super-footer"> <div class="super-nav-box"> <div class="site-logo"></div> <div class="site-buttons"> <div class="table-wrapper"><table> <tr> <td> <a class="link-button active" href="/">Documentation</a> </td> <td> <a class="link-button" href="https://napkinweb.webflow.io/usecases" target="_blank" rel="noopener noreferrer">Use Cases</a> </td> <td> <span class="gradient-border"> <a class="link-button" href="/install/">Get Napkin</a> </span> </td> </tr> <tr> <td> <a class="link-button" href="https://napkinweb.webflow.io/community" target="_blank" rel="noopener noreferrer">Community</a> </td> <td> <a class="link-button" href="https://napkinweb.webflow.io/about" target="_blank" rel="noopener noreferrer">About Napkin</a> </td> </tr> <tr> <td> <a class="link-button" href="https://napkinweb.webflow.io/features" target="_blank" rel="noopener noreferrer">Features</a> </td> <td> <a class="link-button" href="https://napkinweb.webflow.io/contact" target="_blank" rel="noopener noreferrer">Contact</a> </td> </tr> </table></div> </div> <div class="media-bar"> <div class="media-pad"><a href="#" class="inline-icon facebook"></a></div> <div class="media-pad"><a href="#" class="inline-icon twitter"></a></div> <div class="media-pad"><a href="#" class="inline-icon linked-in"></a></div> </div> <div class="copyright"> <div class="left"> Copyright 2022 © </div> <div class="right"> Made with <span class="heart"> </span> in NYC </div> </div> </div> </div> <script type="text/javascript" src="/assets/js/copy.js"></script> </body> </html>
