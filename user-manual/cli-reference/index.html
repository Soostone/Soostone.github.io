<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>CLI reference</title> <meta name="generator" content="Jekyll v4.2.1" /> <meta property="og:title" content="CLI reference" /> <meta name="author" content="Alex Shestakov" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Napkin tutorials for data scientists and analytics using BigQuery, Postgres, Sqlite and other NoSql/SQL systems." /> <meta property="og:description" content="Napkin tutorials for data scientists and analytics using BigQuery, Postgres, Sqlite and other NoSql/SQL systems." /> <link rel="canonical" href="https://soostone.github.io/user-manual/cli-reference/" /> <meta property="og:url" content="https://soostone.github.io/user-manual/cli-reference/" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="CLI reference" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Alex Shestakov"},"description":"Napkin tutorials for data scientists and analytics using BigQuery, Postgres, Sqlite and other NoSql/SQL systems.","headline":"CLI reference","url":"https://soostone.github.io/user-manual/cli-reference/"}</script> <!-- End Jekyll SEO tag --> <script src="https://code.jquery.com/jquery-3.6.0.slim.min.js" integrity="sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI=" crossorigin="anonymous"></script> <script type="text/javascript" src="/assets/js/resize.js"></script> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewbox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewbox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewbox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewbox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewbox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="#" id="menu-button" class="site-button"> <svg viewbox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list">
<li class="nav-list-item"><a href="https://soostone.github.io/" class="nav-list-link">About</a></li>
<li class="nav-list-item"><a href="https://soostone.github.io/getting-started/" class="nav-list-link">Getting started</a></li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://soostone.github.io/install/" class="nav-list-link">Installation</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://soostone.github.io/install#native" class="nav-list-link">Native</a></li>
<li class="nav-list-item "><a href="https://soostone.github.io/install#homebrew" class="nav-list-link">Homebrew</a></li>
<li class="nav-list-item "><a href="https://soostone.github.io/install#docker" class="nav-list-link">Docker</a></li>
<li class="nav-list-item "><a href="https://soostone.github.io/install#cachix" class="nav-list-link">Cachix</a></li>
</ul>
</li>
<li class="nav-list-item"><a href="https://soostone.github.io/fundamentals/" class="nav-list-link">Fundamentals</a></li>
<li class="nav-list-item"><a href="https://soostone.github.io/tips-and-tricks/" class="nav-list-link">Tips and Tricks</a></li>
<li class="nav-list-item active">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://soostone.github.io/user-manual/" class="nav-list-link">User Manual</a><ul class="nav-list ">
<li class="nav-list-item active"><a href="https://soostone.github.io/user-manual/cli-reference/" class="nav-list-link active">CLI reference</a></li>
<li class="nav-list-item "><a href="https://soostone.github.io/user-manual/db-connection/" class="nav-list-link">Connecting to the database</a></li>
<li class="nav-list-item "><a href="https://soostone.github.io/user-manual/devcontainer/" class="nav-list-link">Devcontainer</a></li>
<li class="nav-list-item "><a href="https://soostone.github.io/user-manual/docker/" class="nav-list-link">Docker</a></li>
<li class="nav-list-item "><a href="https://soostone.github.io/user-manual/ide/" class="nav-list-link">IDE Support</a></li>
<li class="nav-list-item "><a href="https://soostone.github.io/user-manual/multi-environment/" class="nav-list-link">Multi-environment pipelines in a team setting</a></li>
<li class="nav-list-item "><a href="https://soostone.github.io/user-manual/mustache/" class="nav-list-link">Mustache Interpolation</a></li>
<li class="nav-list-item "><a href="https://soostone.github.io/user-manual/preprocessors/" class="nav-list-link">Preprocessors</a></li>
<li class="nav-list-item "><a href="https://soostone.github.io/user-manual/github-actions/" class="nav-list-link">Running as a scheduled job on GitHub Actions</a></li>
<li class="nav-list-item "><a href="https://soostone.github.io/user-manual/yaml-reference/" class="nav-list-link">Spec YAML reference</a></li>
<li class="nav-list-item "><a href="https://soostone.github.io/user-manual/spec-arguments/" class="nav-list-link">Spec arguments</a></li>
</ul>
</li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://soostone.github.io/metaprogramming/" class="nav-list-link">Metaprogramming</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://soostone.github.io/metaprogramming/haskell/" class="nav-list-link">Haskell API</a></li>
<li class="nav-list-item "><a href="https://soostone.github.io/metaprogramming/repl/" class="nav-list-link">REPL</a></li>
<li class="nav-list-item "><a href="https://soostone.github.io/metaprogramming/custom-hooks/" class="nav-list-link">Writing Custom Hooks</a></li>
</ul>
</li>
<li class="nav-list-item"><a href="https://soostone.github.io/haddock/" class="nav-list-link">API Reference</a></li>
<li class="nav-list-item"><a href="https://soostone.github.io/changelog/" class="nav-list-link">Changelog</a></li>
</ul> </nav> </div> <div class="site-super-header"> <div class="super-nav-box"> <div class="site-logo"></div> <div class="site-buttons"> <a class="link-button active" href="/">Documentation</a> <a class="link-button" href="https://napkinweb.webflow.io/community" target="_blank" rel="noopener noreferrer">Community</a> <a class="link-button" href="https://napkinweb.webflow.io/features" target="_blank" rel="noopener noreferrer">Features</a> <a class="link-button" href="https://napkinweb.webflow.io/usecases" target="_blank" rel="noopener noreferrer">Use Cases</a> <span class="gradient-border"> <a class="link-button" href="/install/">Install</a> </span> </div> </div> </div> <div class="width-ruler"></div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search " aria-label="Search " autocomplete="off"> <label for="search-input" class="search-label"><svg viewbox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="https://soostone.github.io/user-manual/">User Manual</a></li> <li class="breadcrumb-nav-list-item"><span>CLI reference</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <ul id="markdown-toc"> <li>
<a href="#napkin" id="markdown-toc-napkin">Napkin</a> <ul> <li><a href="#init" id="markdown-toc-init">Init</a></li> <li>
<a href="#run" id="markdown-toc-run">Run</a> <ul> <li><a href="#cli-ui" id="markdown-toc-cli-ui">CLI UI</a></li> <li><a href="#dry-runs" id="markdown-toc-dry-runs">Dry runs</a></li> <li>
<a href="#partial-spec-runs" id="markdown-toc-partial-spec-runs">Partial spec runs</a> <ul> <li><a href="#table-selectors" id="markdown-toc-table-selectors">Table selectors</a></li> <li><a href="#example-use-cases" id="markdown-toc-example-use-cases">Example use cases</a></li> </ul> </li> <li><a href="#meta-arguments" id="markdown-toc-meta-arguments">Meta arguments</a></li> <li><a href="#other-options" id="markdown-toc-other-options">Other options</a></li> </ul> </li> <li>
<a href="#history" id="markdown-toc-history">History</a> <ul> <li><a href="#list" id="markdown-toc-list">List</a></li> <li><a href="#show" id="markdown-toc-show">Show</a></li> <li><a href="#gantt" id="markdown-toc-gantt">Gantt</a></li> </ul> </li> <li><a href="#validate" id="markdown-toc-validate">Validate</a></li> <li><a href="#dump" id="markdown-toc-dump">Dump</a></li> <li>
<a href="#optimize" id="markdown-toc-optimize">Optimize</a> <ul> <li><a href="#unused-cte-column" id="markdown-toc-unused-cte-column">Unused CTE column</a></li> <li><a href="#duplicated-cte" id="markdown-toc-duplicated-cte">Duplicated CTE</a></li> </ul> </li> <li><a href="#haddock" id="markdown-toc-haddock">Haddock</a></li> <li><a href="#docs" id="markdown-toc-docs">Docs</a></li> <li><a href="#repl" id="markdown-toc-repl">REPL</a></li> <li><a href="#yaml-schema" id="markdown-toc-yaml-schema">Yaml-Schema</a></li> <li><a href="#hie-bios" id="markdown-toc-hie-bios">Hie-Bios</a></li> <li><a href="#version" id="markdown-toc-version">Version</a></li> </ul> </li> </ul> <h1 id="napkin">Napkin</h1> <p>Napkin CLI application has a number of commands to develop, debug and execute specs</p> <div class="highlighter-rouge"><pre>Usage: napkin [(-v|--verbose) | (-l|--log-level LOG_LEVEL)] 
              [--log-format LOG_FORMAT] COMMAND
  CLI tool to work with Napkin

Available options:
  <a href="#napkin--v,--verbose">-v,--verbose</a>             Print debug log
  <a href="#napkin--l,--log-level">-l,--log-level</a> LOG_LEVEL Log severity level. Possible values: Debug, Info,
                           Notice, Warning, Error, Critical, Alert, Emergency.
                           (default: Info)
  <a href="#napkin---log-format">--log-format</a> LOG_FORMAT  Log line format. Possible values: Simple, Server,
                           Json. (default: Simple)
  <a href="#napkin--h,--help">-h,--help</a>                Show this help text

Init:
  <a href="#init">init</a>                     Generates Napkin project from a template
  templates                Lists embedded Napkin templates
  generate-spec            Generates a Napkin spec from a directory of SQL files

Execute:
  <a href="#run">run</a>                      Runs Napkin specs
  <a href="#history">history</a>                  Set of commands to work with Napkin previous runs
  auth                     Authenticates with Google BigQuery

Develop:
  <a href="#validate">validate</a>                 Validates YAML spec file
  <a href="#dump">dump</a>                     Performs a dry run and stores queries for inspection
  repl                     Drops into Napkin repl
  <a href="#optimize">optimize</a>                 Discovers unused CTE columns in spec queries

Documentation:
  <a href="#haddock">haddock</a>                  Opens web page with Napkin haddocks
  <a href="#docs">docs</a>                     Opens web page with Napkin tutorial

IDE integration:
  <a href="#yaml-schema">yaml-schema</a>              Stores YAML schema in a file
  <a href="#hie-bios">hie-bios</a>                 Used by Haskell Language Server

Version:
  <a href="#version">version</a>                  Prints Git SHA and version of the build
</pre></div> <p>Napkin has number of global options, which are applicable to almost any command:</p> <p><a name="napkin--l,--log-level"></a></p> <ul> <li>
<code class="language-plaintext highlighter-rouge">-l</code>, <code class="language-plaintext highlighter-rouge">--log-level</code> - Allows to specify log level for the Napkin execution. <a name="napkin--v,--verbose"></a>
</li> <li>
<code class="language-plaintext highlighter-rouge">-v</code>, <code class="language-plaintext highlighter-rouge">--verbose</code> - Enables debug logging, equivalent of providing <code class="language-plaintext highlighter-rouge">--log-level Debug</code>. <a name="napkin---log-format"></a>
</li> <li>
<code class="language-plaintext highlighter-rouge">--log-format</code> - Allows to choose desired format of the log messages. Currently supported: <ul> <li>
<a href="https://github.com/Soostone/katip/blob/62d2f9beabc7d0d16340eb192941de306127bfbd/katip/src/Katip/Scribes/Handle.hs#L138-L144" target="_blank" rel="noopener noreferrer"><code class="language-plaintext highlighter-rouge">Server</code></a> log format uses Katip’s <code class="language-plaintext highlighter-rouge">bracketFormat</code>.</li> <li>
<a href="http://soostone-napkin-public.s3-website.us-east-1.amazonaws.com/haddock/git-hash/4cb2d92a627f4ddf6d00be2d48329be847536a7d/Napkin-Logging.html#v:simpleFormat" target="_blank" rel="noopener noreferrer"><code class="language-plaintext highlighter-rouge">Simple</code></a> log format is a simplified version of Katip’s <code class="language-plaintext highlighter-rouge">bracketFormat</code>.</li> <li>
<a href="https://github.com/Soostone/katip/blob/62d2f9beabc7d0d16340eb192941de306127bfbd/katip/src/Katip/Scribes/Handle.hs#L138-L144" target="_blank" rel="noopener noreferrer"><code class="language-plaintext highlighter-rouge">Json</code></a> log format uses Katip’s <code class="language-plaintext highlighter-rouge">jsonFormat</code>. <a name="napkin--h,--help"></a>
</li> </ul> </li> <li>
<code class="language-plaintext highlighter-rouge">-h</code>, <code class="language-plaintext highlighter-rouge">--help</code> - Displays traditional help message screen for each command. It is usually “safe” to append <code class="language-plaintext highlighter-rouge">--help</code> to any Napkin command to know more about options it supports. Napkin will also display the <code class="language-plaintext highlighter-rouge">--help</code> screen when it meets the unfamiliar option.</li> </ul> <h2 id="init">Init</h2> <p>Napkin project is a folder with a set of various files including a spec file in YAML format having lots of fields.</p> <p class="text-delta text-center">shell</p> <div class="language-sh copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code>napkin init <span class="nt">--help</span>
</code></pre></div></div> <div class="highlighter-rouge"><pre>Usage: napkin init [-t|--template TPL_REF] [-p|--parameter KEY=VALUE] 
                   [-n|--project-name PROJECT_NAME] [-f|--force] 
                   [-c|--current-dir] [-g|--init-git-repo]
  Generates Napkin project from a template

Available options:
  <a href="#napkin-init--t,--template">-t,--template</a> TPL_REF    Template location:
                               [[service='github':]user/repo/template-name
                               service = (gitlab|bitbucket|github),
                               or local path/url or :&lt;embedded template name&gt;
                           (default: :basic)
  <a href="#napkin-init--p,--parameter">-p,--parameter</a> KEY=VALUE Set custom template parameter
  -n,--project-name PROJECT_NAME
                           Name of the project to create
                           (default: "napkin-project")
  <a href="#napkin-init--f,--force">-f,--force</a>               Overwrite existing files in case of name collision
                           with files from a template
  <a href="#napkin-init--c,--current-dir">-c,--current-dir</a>         Use current directory for the project
  <a href="#napkin-init--g,--init-git-repo">-g,--init-git-repo</a>       Init Git repository in the project folder
  <a href="#napkin--h,--help">-h,--help</a>                Show this help text

Global options:
  <a href="#napkin--v,--verbose">-v,--verbose</a>             Print debug log
  <a href="#napkin--l,--log-level">-l,--log-level</a> LOG_LEVEL Log severity level. Possible values: Debug, Info,
                           Notice, Warning, Error, Critical, Alert, Emergency.
                           (default: Info)
  <a href="#napkin---log-format">--log-format</a> LOG_FORMAT  Log line format. Possible values: Simple, Server,
                           Json. (default: Simple)

Generates Napkin project from a template.
Napkin contains embedded set of templates starting with ":".
You can use custom templates from github, gitlab and bitbucket.
mustache syntax is used for content description.
Template variables are resolved with process environment variables
and -p parameters override them.
</pre></div> <p><a name="napkin-init--n,--project-name"></a></p> <ul> <li>With <code class="language-plaintext highlighter-rouge">-n</code>, or <code class="language-plaintext highlighter-rouge">--project-name</code> you can specify the name of the project to create. By default, Napkin will try to create a new directory with this name. <a name="napkin-init--t,--template"></a>
</li> <li>
<code class="language-plaintext highlighter-rouge">-t</code>, <code class="language-plaintext highlighter-rouge">--template</code> allows to specify the template (builtin or external) for the Napkin to use. <a name="napkin-init--p,--parameter"></a>
</li> <li>
<code class="language-plaintext highlighter-rouge">-p</code>, <code class="language-plaintext highlighter-rouge">--parameter</code> option allows to override variables within the template with custom values. <a name="napkin-init--f,--force"></a>
</li> <li>
<code class="language-plaintext highlighter-rouge">-f</code>, <code class="language-plaintext highlighter-rouge">--force</code> flag will force Napkin to override target directory (see <a href="#napkin-init--n,--project-name"><code class="language-plaintext highlighter-rouge">--project-name</code></a> option) if it already exists or files created in the current directory in case of <a href="#napkin-init--c,--current-dir"><code class="language-plaintext highlighter-rouge">--current-dir</code></a> was specified. <a name="napkin-init--c,--current-dir"></a>
</li> <li>With <code class="language-plaintext highlighter-rouge">-c</code>, <code class="language-plaintext highlighter-rouge">--current-dir</code> option, Napkin will use current working directory to write new files into. <a name="napkin-init--g,--init-git-repo"></a>
</li> <li>With <code class="language-plaintext highlighter-rouge">-g</code>, <code class="language-plaintext highlighter-rouge">--init-git-repo</code>, Napkin will additionally execute <code class="language-plaintext highlighter-rouge">git init</code> command in the directory used to created a new project.</li> </ul> <p>If you start a project from scratch then <a href="#init">init</a> command could save a few seconds by generating minimum working set and setting up a GIT repo.</p> <p>A generated project is based on a <a href="https://github.com/commercialhaskell/stack-templates/wiki" target="_blank" rel="noopener noreferrer">hsfiles</a> template. Napkin has a builtin <code class="language-plaintext highlighter-rouge">:basic</code> template, but you can define your own templates and supply an url to a repo with them on github e.g. Template file is a list of <a href="https://github.com/mustache/spec" target="_blank" rel="noopener noreferrer">mustache</a> snippets for every file in a project tree.</p> <p>For example, following command will create napkin project with name <code class="language-plaintext highlighter-rouge">napkinFromScratch</code> from <code class="language-plaintext highlighter-rouge">:basic</code> template:</p> <p class="text-delta text-center">shell</p> <div class="language-sh copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code>napkin init <span class="nt">-n</span> napkinFromScratch <span class="nt">-t</span> :basic
</code></pre></div></div> <h2 id="run">Run</h2> <p><code class="language-plaintext highlighter-rouge">napkin run</code> is used to execute Specs. It provides a handful of options that enable you to adjust how the spec is going to be executed. In a summary, you can:</p> <ul> <li>perform a partial run that will execute only a subset of defined tables,</li> <li>perform a dry-run and inspect the execution plan,</li> <li>pass spec arguments,</li> <li>enable CLI UI,</li> <li>override database connection settings.</li> </ul> <p>Lets review the CLI command:</p> <p class="text-delta text-center">shell</p> <div class="language-sh copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code>napkin run <span class="nt">--help</span>
</code></pre></div></div> <div class="highlighter-rouge"><pre>Usage: napkin run [-s|--spec-file SPEC_YAML] 
                  [--override /json/pointer={"json": "value"}] 
                  [-Q|--metadata-connection-string URI] [-u|--uri URI] 
                  [-a|--app-name APPLICATION-NAME] 
                  [--credentials-db CREDENTIALS-DB-PATH] 
                  [--callback-http-port CALLBACK_HTTP_PORT] 
                  [-S|--strict-mustache] [-C|--credentials-file FILE] 
                  [--skip-all | --force-all | --only SELECTOR | 
                    <a href="#napkin-run---force-only">--force-only</a> SELECTOR] 
                  [--force SELECTOR | --force-with-downstream SELECTOR | 
                    <a href="#napkin-run---enable">--enable</a> SELECTOR | --skip SELECTOR] [-p|--show-progress] 
                  [-r|--dry-run] 
                  [--arg ARG=VALUE | --arg-json JSON | --arg-file FILE]
  Runs Napkin specs

Available options:
  <a href="#napkin--s,--spec-file">-s,--spec-file</a> SPEC_YAML Path to the spec yaml file
                           (default: "specs/spec.yaml")
  <a href="#napkin---override">--override</a> /json/pointer={"json": "value"}
                           Set arbitrary JSON pointer (RFC 6901) in YAML spec
                           with the new value
  <a href="#napkin--Q,--metadata-connection-string">-Q,--metadata-connection-string</a> URI
                           An optional alternate connection string for tracking
                           napkin operations. Currently supports SQLite3 and
                           Postgres backends, e.g. sqlite:/some/file.sqlite3 or
                           postgresql://user@host
  <a href="#napkin-run--u,--uri">-u,--uri</a> URI             Connection URI to create a database connection
                           postgres:/// # use libpq defaults
                           postgres://user@remotehost/dbname
                           redshift://user@remotehost/dbname
                           bigquery://bigquery.googleapis.com/project?dataset=datasetname
                           sqlite:///home/dev/myRepo/mySqlite.db
  <a href="#napkin--a,--app-name">-a,--app-name</a> APPLICATION-NAME
                           User's project or application name
  <a href="#napkin-run---credentials-db">--credentials-db</a> CREDENTIALS-DB-PATH
                           Path to database connection credentials directory
  <a href="#napkin-run---callback-http-port">--callback-http-port</a> CALLBACK_HTTP_PORT
                           Network port number for the napkin Auth server
  <a href="#napkin--S,--strict-mustache">-S,--strict-mustache</a>     Strict mustache validation mode
  <a href="#napkin-run--C,--credentials-file">-C,--credentials-file</a> FILE
                           Path to database connection credentials file
  <a href="#napkin-run---skip-all">--skip-all</a>               Table selector: Skip all tables, use other options to
                           enable selected tables
  <a href="#napkin-run---force-all">--force-all</a>              Table selector: Force-enable update of all tables, use other options to skip selected tables
  <a href="#napkin-run---only">--only</a> SELECTOR          Table selector: Disable all tables except specified
  <a href="#napkin-run---force-only">--force-only</a> SELECTOR    Table selector: Disable all tables except specified which will be forced
  <a href="#napkin-run---force">--force</a> SELECTOR         Table selector: Force table update
  <a href="#napkin-run---force-with-downstream">--force-with-downstream</a> SELECTOR
                           Table selector: Force table update, force downstream tables too
  <a href="#napkin-run---enable">--enable</a> SELECTOR        Table selector: Don't skip or force table, use the update strategy as specified in the Spec file
  <a href="#napkin-run---skip">--skip</a> SELECTOR          Table selector: Skip table update
  <a href="#napkin-run--p,--show-progress">-p,--show-progress</a>       Show a progress bar if the terminal supports it
  <a href="#napkin-run--r,--dry-run">-r,--dry-run</a>             Simulate run and report which tables would've been
                           updated
  <a href="#napkin---arg">--arg</a> ARG=VALUE          Argument to be passed to spec
  <a href="#napkin---arg-json">--arg-json</a> JSON          Spec arguments encoded as JSON object
  <a href="#napkin---arg-file">--arg-file</a> FILE          Spec arguments stored in JSON file
  <a href="#napkin--h,--help">-h,--help</a>                Show this help text

Global options:
  <a href="#napkin--v,--verbose">-v,--verbose</a>             Print debug log
  <a href="#napkin--l,--log-level">-l,--log-level</a> LOG_LEVEL Log severity level. Possible values: Debug, Info,
                           Notice, Warning, Error, Critical, Alert, Emergency.
                           (default: Info)
  <a href="#napkin---log-format">--log-format</a> LOG_FORMAT  Log line format. Possible values: Simple, Server,
                           Json. (default: Simple)

Table selectors and SELECTOR types
  
  Table selectors allow performing partial spec runs. This can be useful during
  spec development. All options are applied in sequence to the execution plan.
  --skip-all, --force-all, --only, and --force-only options can be specified as
  a first table selector only. --only, --force-only, --skip, --enable, --force,
  and --force-with-downstream options accept a SELECTOR, which can be one of:
    * unprocessed table name, as it was defined in the spec,
      e.g. --skip spec:marketing_analytics,
    * processed table name after all preprocessors have been applied,
      e.g. --skip db:development.john_marketing_analytics,
    * table tag, e.g. --enable tag:marketing.
  Table names can be filtered using three matchers:
    * literal table name, e.g. --skip spec:marketing_analytics,
    * table name pattern - an asterisk can be used as a wildcard at the
      beginning or at the end of each table name segment,
      e.g. --force spec:prod_*.marketing_*,
    * table name regex - regex has to be surrounded with /,
      e.g. --force spec:/^marketing.*/,
  Please refer to the User Manual for further reference.
  
  Example:
    napkin run --only tag:marketing --enable spec:sales_totals --skip spec:marketing_mailing_*
</pre></div> <h3 id="cli-ui">CLI UI</h3> <p><a name="napkin-run--p,--show-progress"></a></p> <ul> <li>
<code class="language-plaintext highlighter-rouge">-p</code>, <code class="language-plaintext highlighter-rouge">--show-progress</code> – will enable terminal UI that will display spec execution progress.</li> </ul> <p><img src="/user-manual/cli-reference/run-ui.png" alt="Napkin CLI UI"></p> <h3 id="dry-runs">Dry runs</h3> <p><a name="napkin-run--r,--dry-run"></a></p> <ul> <li>
<code class="language-plaintext highlighter-rouge">-r</code>, <code class="language-plaintext highlighter-rouge">--dry-run</code> – will perform a dry run of the Spec. Napkin will always print Spec execution plan prior to executing queries, so this can be used to verify if partial run options have been applied correctly:</li> </ul> <p class="text-delta text-center">shell</p> <div class="language-sh copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code>napkin run <span class="nt">--dry-run</span> <span class="nt">--force-only</span> <span class="s2">"spec:artist*"</span> <span class="nt">--skip</span> <span class="s2">"spec:*hashes*"</span>
</code></pre></div></div> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span><span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">13</span> <span class="mi">10</span><span class="o">:</span><span class="mi">30</span><span class="o">:</span><span class="mo">00</span><span class="o">][</span><span class="nc">Info</span><span class="o">]</span> <span class="nc">Determining</span> <span class="n">tables</span> <span class="k">for</span> <span class="n">update</span><span class="o">...</span>
<span class="o">[</span><span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">13</span> <span class="mi">10</span><span class="o">:</span><span class="mi">30</span><span class="o">:</span><span class="mo">00</span><span class="o">][</span><span class="nc">Info</span><span class="o">]</span> <span class="nc">Forced</span> <span class="nl">tables:</span> <span class="n">none</span>
<span class="o">[</span><span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">13</span> <span class="mi">10</span><span class="o">:</span><span class="mi">30</span><span class="o">:</span><span class="mo">00</span><span class="o">][</span><span class="nc">Info</span><span class="o">]</span> <span class="nc">Skipped</span> <span class="nl">tables:</span>
<span class="o">-</span> <span class="n">artists_hashes</span> <span class="o">-&gt;</span> <span class="n">development</span><span class="o">.</span><span class="na">unknown_artists_hashes</span>
<span class="o">-</span> <span class="n">day_totals</span> <span class="o">-&gt;</span> <span class="n">development</span><span class="o">.</span><span class="na">unknown_day_totals</span>
<span class="o">-</span> <span class="n">day_totals_2</span> <span class="o">-&gt;</span> <span class="n">development</span><span class="o">.</span><span class="na">unknown_day_totals_2</span>
<span class="o">-</span> <span class="n">first_run_at</span> <span class="o">-&gt;</span> <span class="n">development</span><span class="o">.</span><span class="na">unknown_first_run_at</span>
<span class="o">-</span> <span class="n">long_to_wide</span> <span class="o">-&gt;</span> <span class="n">development</span><span class="o">.</span><span class="na">unknown_long_to_wide</span>
<span class="o">-</span> <span class="n">popular_tracks_for_pink_floyd</span> <span class="o">-&gt;</span> <span class="n">development</span><span class="o">.</span><span class="na">unknown_popular_tracks_for_pink_floyd</span>
<span class="o">-</span> <span class="n">random</span> <span class="o">-&gt;</span> <span class="n">development</span><span class="o">.</span><span class="na">unknown_random</span>
<span class="o">-</span> <span class="n">total_sales_by_year</span> <span class="o">-&gt;</span> <span class="n">development</span><span class="o">.</span><span class="na">unknown_total_sales_by_year</span>
<span class="o">-</span> <span class="n">update_daily</span> <span class="o">-&gt;</span> <span class="n">development</span><span class="o">.</span><span class="na">unknown_update_daily</span>
<span class="o">-</span> <span class="n">update_on_upstream</span> <span class="o">-&gt;</span> <span class="n">development</span><span class="o">.</span><span class="na">unknown_update_on_upstream</span>

<span class="o">[</span><span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">13</span> <span class="mi">10</span><span class="o">:</span><span class="mi">30</span><span class="o">:</span><span class="mo">00</span><span class="o">][</span><span class="nc">Info</span><span class="o">]</span> <span class="nc">Unmanaged</span> <span class="n">tables</span> <span class="n">that</span> <span class="n">will</span> <span class="n">be</span> <span class="n">used</span> <span class="n">as</span> <span class="n">an</span> <span class="n">input</span> <span class="n">in</span> <span class="k">this</span> <span class="nl">run:</span>
<span class="o">-</span> <span class="n">chinook</span><span class="o">.</span><span class="na">Album</span>
<span class="o">-</span> <span class="n">chinook</span><span class="o">.</span><span class="na">Artist</span>
<span class="o">-</span> <span class="n">chinook</span><span class="o">.</span><span class="na">Track</span>

<span class="o">[</span><span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">13</span> <span class="mi">10</span><span class="o">:</span><span class="mi">30</span><span class="o">:</span><span class="mo">00</span><span class="o">][</span><span class="nc">Info</span><span class="o">]</span> <span class="nc">Managed</span> <span class="n">tables</span> <span class="n">that</span> <span class="n">will</span> <span class="n">be</span> <span class="n">used</span> <span class="n">as</span> <span class="n">an</span> <span class="n">input</span> <span class="n">in</span> <span class="k">this</span> <span class="n">run</span><span class="o">,</span> <span class="n">but</span> <span class="n">will</span> <span class="n">not</span> <span class="n">be</span> <span class="nl">updated:</span> <span class="n">none</span>
<span class="o">[</span><span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">13</span> <span class="mi">10</span><span class="o">:</span><span class="mi">30</span><span class="o">:</span><span class="mo">00</span><span class="o">][</span><span class="nc">Info</span><span class="o">]</span> <span class="nc">Managed</span> <span class="n">tables</span> <span class="n">that</span> <span class="n">will</span> <span class="n">be</span> <span class="n">updated</span> <span class="n">in</span> <span class="k">this</span> <span class="nl">run:</span>
<span class="o">-</span> <span class="n">artist_album_count</span> <span class="o">-&gt;</span> <span class="n">development</span><span class="o">.</span><span class="na">unknown_artist_album_count</span>
<span class="o">-</span> <span class="n">artist_album_count_via_mustache</span> <span class="o">-&gt;</span> <span class="n">development</span><span class="o">.</span><span class="na">unknown_artist_album_count_via_mustache</span>
<span class="o">-</span> <span class="n">artist_album_count_via_mustache_2</span> <span class="o">-&gt;</span> <span class="n">development</span><span class="o">.</span><span class="na">unknown_artist_album_count_via_mustache_2</span>
<span class="o">-</span> <span class="n">artist_track_count</span> <span class="o">-&gt;</span> <span class="n">development</span><span class="o">.</span><span class="na">unknown_artist_track_count</span>
<span class="o">-</span> <span class="n">artist_track_count_2</span> <span class="o">-&gt;</span> <span class="n">development</span><span class="o">.</span><span class="na">unknown_artist_track_count_2</span>
<span class="o">-</span> <span class="n">artist_track_count_view</span> <span class="o">-&gt;</span> <span class="n">development</span><span class="o">.</span><span class="na">unknown_artist_track_count_view</span>

<span class="o">[</span><span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">13</span> <span class="mi">10</span><span class="o">:</span><span class="mi">30</span><span class="o">:</span><span class="mo">00</span><span class="o">][</span><span class="nc">Info</span><span class="o">]</span> <span class="nc">Estimated</span> <span class="nl">runtime:</span> <span class="mi">35</span><span class="n">s</span>
<span class="o">[</span><span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">13</span> <span class="mi">10</span><span class="o">:</span><span class="mi">30</span><span class="o">:</span><span class="mo">00</span><span class="o">][</span><span class="nc">Warning</span><span class="o">]</span> <span class="nc">Dry</span> <span class="n">run</span><span class="o">,</span> <span class="n">aborting</span> <span class="n">execution</span><span class="o">.</span>
</code></pre></div></div> <h3 id="partial-spec-runs">Partial spec runs</h3> <p>During Spec development it’s convenient to execute only tables the developer is working on. This allows for shorter feedback loop and can reduce costs as well. Napkin provides a number of command-line options that can be used to cherry-pick tables that will be executed during particular run. However, we don’t recommend using them for production runs.</p> <p>All flags mentioned below will amend the execution plan in their order of appearance.</p> <p>Initial execution plan:</p> <p><a name="napkin-run---skip-all"></a></p> <ul> <li>
<code class="language-plaintext highlighter-rouge">--skip-all</code> will disable execution of all tables. Typically, it’d be combined with other options that will enable or force some tables. <a name="napkin-run---force-all"></a>
</li> <li>
<code class="language-plaintext highlighter-rouge">--force-all</code> will force execution of all tables. This overrides any update strategy that was set in table definitions. <a name="napkin-run---only"></a>
</li> <li>
<code class="language-plaintext highlighter-rouge">--only</code> will disable execution of all tables and enable tables that fulfill the selector. This brings back any update strategy that was set in table definitions. Synonym of <code class="language-plaintext highlighter-rouge">--skip-all --enable SELECTOR</code>. <a name="napkin-run---force-only"></a>
</li> <li>
<code class="language-plaintext highlighter-rouge">--force-only</code> will disable execution of all tables and force tables that fulfill the selector. This overrides any update strategy that was set in table definitions. Synonym of <code class="language-plaintext highlighter-rouge">--skip-all --force SELECTOR</code>.</li> </ul> <p>Updating execution plan:</p> <p><a name="napkin-run---force"></a></p> <ul> <li>
<code class="language-plaintext highlighter-rouge">--force</code> will force tables that fulfill the selector. This overrides any update strategy that was set in table definitions. <a name="napkin-run---force-with-downstream"></a>
</li> <li>
<code class="language-plaintext highlighter-rouge">--force-with-downstream</code> will force tables that fulfill the selector as well as all tables depend on them. This overrides any update strategy that was set in table definitions. <a name="napkin-run---enable"></a>
</li> <li>
<code class="language-plaintext highlighter-rouge">--enable</code> will void any changes to execution plan that were introduced with previous option for tables that fulfill the selector and will bring back any update strategy that was set in table definitions. <a name="napkin-run---skip"></a>
</li> <li>
<code class="language-plaintext highlighter-rouge">--skip</code> will disable execution of the tables that fulfill the selector.</li> </ul> <h4 id="table-selectors">Table selectors</h4> <p><code class="language-plaintext highlighter-rouge">--only</code>, <code class="language-plaintext highlighter-rouge">--force-only</code>, <code class="language-plaintext highlighter-rouge">--force</code>, <code class="language-plaintext highlighter-rouge">--force-with-downstream</code>, <code class="language-plaintext highlighter-rouge">--enable</code>, and <code class="language-plaintext highlighter-rouge">--skip</code> options accept a table selector. Napkin will fail when no tables match a selector, which may indicate user error.</p> <ul> <li>
<code class="language-plaintext highlighter-rouge">db:PATTERN</code> – will match against preprocessed table names (with all renaming applied). Wildcards or regular expressions may be used to match multiple tables.</li> <li>
<code class="language-plaintext highlighter-rouge">spec:PATTERN</code> – will match against unprocessed table names, i.e. the table names as they were specified in the spec file. Wildcards or regular expressions may be used to match multiple tables. If no renaming was done with preprocessors <code class="language-plaintext highlighter-rouge">db:</code> and <code class="language-plaintext highlighter-rouge">spec:</code> selectors will have the same effect.</li> <li>
<code class="language-plaintext highlighter-rouge">tag:TAG</code> – will match table tags. Wildcards or regular expressions cannot be used for tags.</li> </ul> <p>Where PATTERN can be:</p> <ul> <li>
<code class="language-plaintext highlighter-rouge">someproject.somedataset.sometable</code> – an exact match.</li> <li>
<code class="language-plaintext highlighter-rouge">someproject.prod_*.*sales*</code> – a wildcard can be used at the beginning and at the end of each name segment, segments are matched separately, so * will never expand beyond name segment: <ul> <li>
<code class="language-plaintext highlighter-rouge">production.derived.*marketing</code> would match <code class="language-plaintext highlighter-rouge">production.derived.new_marketing</code> but not <code class="language-plaintext highlighter-rouge">production.derived_update.marketing</code> which a naive regex would otherwise match.</li> </ul> </li> <li>
<code class="language-plaintext highlighter-rouge">/REGEX/</code> – a regular expression.</li> </ul> <h4 id="example-use-cases">Example use cases</h4> <ul> <li>
<code class="language-plaintext highlighter-rouge">--force-only spec:top_artists</code> will disable all tables except <code class="language-plaintext highlighter-rouge">top_artists</code> table which will be forced,</li> <li>
<code class="language-plaintext highlighter-rouge">--force-only spec:top_*</code> will disable all tables and force all tables that have prefix <code class="language-plaintext highlighter-rouge">top_</code>,</li> <li>
<code class="language-plaintext highlighter-rouge">--force-only db:*.*.top_*</code> will disable all tables and force all tables that have prefix <code class="language-plaintext highlighter-rouge">top_</code> in all projects and datasets,</li> <li>
<code class="language-plaintext highlighter-rouge">--skip-all --force-with-downstream tag:monthly</code> will disable all tables and force tables that have a tag <code class="language-plaintext highlighter-rouge">monthly</code> plus all tables that depend on them.</li> </ul> <h3 id="meta-arguments">Meta arguments</h3> <p><a name="napkin---arg"></a></p> <ul> <li>
<code class="language-plaintext highlighter-rouge">--arg</code> <code class="language-plaintext highlighter-rouge">ARG=VALUE</code> allows to provide <code class="language-plaintext highlighter-rouge">ARG</code> spec argument with the string value of <code class="language-plaintext highlighter-rouge">VALUE</code>. <a name="napkin---arg-json"></a>
</li> <li>
<code class="language-plaintext highlighter-rouge">--arg-json</code> will accept JSON object as an argument that will be interpreted as key-value store. Values don’t need to be strings, they can be any valid JSON object. <a name="napkin---arg-file"></a>
</li> <li>
<code class="language-plaintext highlighter-rouge">--arg-file</code> will read JSON object from a file.</li> </ul> <p>Multiple options <code class="language-plaintext highlighter-rouge">--arg*</code> options can be used at the same time and all data provided will be collected.</p> <h3 id="other-options">Other options</h3> <p><a name="napkin-run--u,--uri"></a></p> <ul> <li>
<code class="language-plaintext highlighter-rouge">-u</code>, <code class="language-plaintext highlighter-rouge">--uri</code> – can be used to override database connection string. This can be useful, if development and production data sets are located on different DB servers. <a name="napkin-run--C,--credentials-file"></a>
</li> <li>
<code class="language-plaintext highlighter-rouge">-C</code>, <code class="language-plaintext highlighter-rouge">--credentials-file</code> can be used to provide database credentials manually. Please refer to <a href="/user-manual/db-connection/">Connecting to the database</a> page. <a name="napkin-run---credentials-db"></a>
</li> <li>
<code class="language-plaintext highlighter-rouge">--credentials-db</code> – can be used to override location of Napkin’s credentials database. <a name="napkin-run---callback-http-port"></a>
</li> <li>
<code class="language-plaintext highlighter-rouge">--callback-http-port</code> – can be used to override Napkin’s HTTP port used for handling BigQuery authorization.</li> </ul> <h2 id="history">History</h2> <p>Set of <code class="language-plaintext highlighter-rouge">napkin history</code> commands allows displaying information from Napkin’s metadata database in various forms.</p> <p>When using Napkin frequently, it might be handy to know:</p> <ul> <li>When Napkin was executed last time</li> <li>What are the statuses of the tables</li> <li>How many records were updated in each table</li> <li>etc.</li> </ul> <p>Napkin assigns a <code class="language-plaintext highlighter-rouge">GUID</code> identifier to each run to uniquely identify it from other <code class="language-plaintext highlighter-rouge">napkin run</code> invocations. Along with <code class="language-plaintext highlighter-rouge">GUID</code> of the execution, Napkin stores the date and time when particular <code class="language-plaintext highlighter-rouge">run</code> command was issued to Napkin.</p> <p>Lets review the CLI command:</p> <p class="text-delta text-center">shell</p> <div class="language-sh copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code>napkin <span class="nb">history</span> <span class="nt">--help</span>
</code></pre></div></div> <div class="highlighter-rouge"><pre>Usage: napkin history [-s|--spec-file SPEC_YAML] 
                      [-a|--app-name APPLICATION-NAME] 
                      [-Q|--metadata-connection-string URI] COMMAND
  Set of commands to work with Napkin previous runs

Available options:
  <a href="#napkin--s,--spec-file">-s,--spec-file</a> SPEC_YAML Path to the spec yaml file
                           (default: "specs/spec.yaml")
  <a href="#napkin--a,--app-name">-a,--app-name</a> APPLICATION-NAME
                           User's project or application name
  <a href="#napkin--Q,--metadata-connection-string">-Q,--metadata-connection-string</a> URI
                           An optional alternate connection string for tracking
                           napkin operations. Currently supports SQLite3 and
                           Postgres backends, e.g. sqlite:/some/file.sqlite3 or
                           postgresql://user@host
  <a href="#napkin--h,--help">-h,--help</a>                Show this help text

Available commands:
  <a href="#list">list</a>                     Lists all previous Napkin runs
  <a href="#show">show</a>                     Displays Napkin run by ID. Uses latest run if ID
                           wasn't provided
  <a href="#gantt">gantt</a>                    Exports Napkin run into a gantt chart. Uses latest
                           run if ID wasn't provided

Global options:
  <a href="#napkin--v,--verbose">-v,--verbose</a>             Print debug log
  <a href="#napkin--l,--log-level">-l,--log-level</a> LOG_LEVEL Log severity level. Possible values: Debug, Info,
                           Notice, Warning, Error, Critical, Alert, Emergency.
                           (default: Info)
  <a href="#napkin---log-format">--log-format</a> LOG_FORMAT  Log line format. Possible values: Simple, Server,
                           Json. (default: Simple)
</pre></div> <p><a name="napkin--s,--spec-file"></a></p> <ul> <li>
<code class="language-plaintext highlighter-rouge">-s</code>, <code class="language-plaintext highlighter-rouge">--spec-file</code> as usual, allows to specify the path to the <a href="/user-manual/yaml-reference/">spec.yaml</a> file. <a name="napkin---override"></a>
</li> <li>
<code class="language-plaintext highlighter-rouge">--override</code> allows to override any values in the <a href="/user-manual/yaml-reference/">spec.yaml</a> file according to the <a href="https://datatracker.ietf.org/doc/html/rfc6901" target="_blank" rel="noopener noreferrer">JSON pointer</a> specification. Can be helpful in cases, where you need to only override several values from <code class="language-plaintext highlighter-rouge">spec.yaml</code> for a particular run. <a name="napkin--a,--app-name"></a>
</li> <li>
<code class="language-plaintext highlighter-rouge">-a</code>, <code class="language-plaintext highlighter-rouge">--app-name</code> allows to override <code class="language-plaintext highlighter-rouge">app-name</code> parameter from the <a href="/user-manual/yaml-reference/">spec.yaml</a> file. <a name="napkin--Q,--metadata-connection-string"></a>
</li> <li>
<code class="language-plaintext highlighter-rouge">-Q</code>, <code class="language-plaintext highlighter-rouge">--metadata-connection-string</code> allows to override the metadata storage location (see <code class="language-plaintext highlighter-rouge">metadata_url</code> parameter in the <a href="/user-manual/yaml-reference/">spec.yaml</a> file) used by Napkin. This might be useful for the situations, when you want to store all metadata information in the central location for further analysis or to ‘port’ Napkin history from a computer, which was earlier used to run Napkin.</li> </ul> <h3 id="list">List</h3> <p class="text-delta text-center">shell</p> <div class="language-sh copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code>napkin <span class="nb">history </span>list <span class="nt">--help</span>
</code></pre></div></div> <div class="highlighter-rouge"><pre>Usage: napkin history list [LIMIT]
  Lists all previous Napkin runs

Available options:
  <a href="#napkin-history-LIMIT">LIMIT</a>                    Number of records to show (default: 10)
  <a href="#napkin--h,--help">-h,--help</a>                Show this help text

Global options:
  <a href="#napkin--s,--spec-file">-s,--spec-file</a> SPEC_YAML Path to the spec yaml file
                           (default: "specs/spec.yaml")
  <a href="#napkin--a,--app-name">-a,--app-name</a> APPLICATION-NAME
                           User's project or application name
  <a href="#napkin--Q,--metadata-connection-string">-Q,--metadata-connection-string</a> URI
                           An optional alternate connection string for tracking
                           napkin operations. Currently supports SQLite3 and
                           Postgres backends, e.g. sqlite:/some/file.sqlite3 or
                           postgresql://user@host
  <a href="#napkin--v,--verbose">-v,--verbose</a>             Print debug log
  <a href="#napkin--l,--log-level">-l,--log-level</a> LOG_LEVEL Log severity level. Possible values: Debug, Info,
                           Notice, Warning, Error, Critical, Alert, Emergency.
                           (default: Info)
  <a href="#napkin---log-format">--log-format</a> LOG_FORMAT  Log line format. Possible values: Simple, Server,
                           Json. (default: Simple)
</pre></div> <p><a name="napkin-history-LIMIT"></a></p> <ul> <li>
<code class="language-plaintext highlighter-rouge">LIMIT</code> parameter allows to specify the amount of records for the <code class="language-plaintext highlighter-rouge">napkin history list</code> command to display. If there are less invocation of the <code class="language-plaintext highlighter-rouge">napkin run</code> in history records, only those records will be displayed.</li> </ul> <p>For example:</p> <p class="text-delta text-center">shell</p> <div class="language-sh copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code>napkin <span class="nb">history </span>list
</code></pre></div></div> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Napkin</span> <span class="n">executed</span> <span class="n">run</span> <span class="n">with</span> <span class="no">ID</span> <span class="n">fd4bf846</span><span class="o">-</span><span class="n">da9c</span><span class="o">-</span><span class="mi">4</span><span class="n">bb4</span><span class="o">-</span><span class="n">a1d0</span><span class="o">-</span><span class="n">b3c971e2d993</span> <span class="n">on</span> <span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">03</span> <span class="mi">16</span><span class="o">:</span><span class="mi">51</span><span class="o">:</span><span class="mi">50</span> <span class="n">with</span> <span class="mi">10</span> <span class="n">tables</span>
<span class="nc">Napkin</span> <span class="n">executed</span> <span class="n">run</span> <span class="n">with</span> <span class="no">ID</span> <span class="mi">4</span><span class="n">fd5e08f</span><span class="o">-</span><span class="n">c03c</span><span class="o">-</span><span class="mi">4</span><span class="n">d6b</span><span class="o">-</span><span class="n">b31d</span><span class="o">-</span><span class="n">d77ff742f8aa</span> <span class="n">on</span> <span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">03</span> <span class="mi">16</span><span class="o">:</span><span class="mi">51</span><span class="o">:</span><span class="mi">45</span> <span class="n">with</span> <span class="mi">17</span> <span class="n">tables</span>
<span class="nc">Napkin</span> <span class="n">executed</span> <span class="n">run</span> <span class="n">with</span> <span class="no">ID</span> <span class="mi">17664</span><span class="n">cb6</span><span class="o">-</span><span class="mi">7357</span><span class="o">-</span><span class="mi">45</span><span class="n">ad</span><span class="o">-</span><span class="mi">9523</span><span class="o">-</span><span class="n">f36daa605a6f</span> <span class="n">on</span> <span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">03</span> <span class="mi">16</span><span class="o">:</span><span class="mi">51</span><span class="o">:</span><span class="mi">31</span> <span class="n">with</span> <span class="mi">10</span> <span class="n">tables</span>
<span class="nc">Napkin</span> <span class="n">executed</span> <span class="n">run</span> <span class="n">with</span> <span class="no">ID</span> <span class="n">a85cc760</span><span class="o">-</span><span class="n">d55e</span><span class="o">-</span><span class="mi">499</span><span class="n">e</span><span class="o">-</span><span class="mi">8</span><span class="n">c00</span><span class="o">-</span><span class="n">a67e4a44f55a</span> <span class="n">on</span> <span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">03</span> <span class="mi">16</span><span class="o">:</span><span class="mi">51</span><span class="o">:</span><span class="mi">16</span> <span class="n">with</span> <span class="mi">16</span> <span class="n">tables</span>
<span class="nc">Napkin</span> <span class="n">executed</span> <span class="n">run</span> <span class="n">with</span> <span class="no">ID</span> <span class="mi">7</span><span class="n">a554ca7</span><span class="o">-</span><span class="mi">61</span><span class="n">dc</span><span class="o">-</span><span class="mi">4884</span><span class="o">-</span><span class="mi">9</span><span class="n">d06</span><span class="o">-</span><span class="n">a4614c9e2827</span> <span class="n">on</span> <span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">03</span> <span class="mi">16</span><span class="o">:</span><span class="mi">51</span><span class="o">:</span><span class="mo">00</span> <span class="n">with</span> <span class="mi">15</span> <span class="n">tables</span>
</code></pre></div></div> <h3 id="show">Show</h3> <p class="text-delta text-center">shell</p> <div class="language-sh copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code>napkin <span class="nb">history </span>show <span class="nt">--help</span>
</code></pre></div></div> <div class="highlighter-rouge"><pre>Usage: napkin history show [GUID]
  Displays Napkin run by ID. Uses latest run if ID wasn't provided

Available options:
  <a href="#napkin-history-GUID">GUID</a>                     GUID of the Napkin run
  <a href="#napkin--h,--help">-h,--help</a>                Show this help text

Global options:
  <a href="#napkin--s,--spec-file">-s,--spec-file</a> SPEC_YAML Path to the spec yaml file
                           (default: "specs/spec.yaml")
  <a href="#napkin--a,--app-name">-a,--app-name</a> APPLICATION-NAME
                           User's project or application name
  <a href="#napkin--Q,--metadata-connection-string">-Q,--metadata-connection-string</a> URI
                           An optional alternate connection string for tracking
                           napkin operations. Currently supports SQLite3 and
                           Postgres backends, e.g. sqlite:/some/file.sqlite3 or
                           postgresql://user@host
  <a href="#napkin--v,--verbose">-v,--verbose</a>             Print debug log
  <a href="#napkin--l,--log-level">-l,--log-level</a> LOG_LEVEL Log severity level. Possible values: Debug, Info,
                           Notice, Warning, Error, Critical, Alert, Emergency.
                           (default: Info)
  <a href="#napkin---log-format">--log-format</a> LOG_FORMAT  Log line format. Possible values: Simple, Server,
                           Json. (default: Simple)
</pre></div> <p><code class="language-plaintext highlighter-rouge">napkin history show</code> command shows individual table statuses, start and finish execution timestamps, number of affected rows.</p> <p class="text-delta text-center">shell</p> <div class="language-sh copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code>napkin <span class="nb">history </span>show 7a554ca7-61dc-4884-9d06-a4614c9e2827
</code></pre></div></div> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Table</span> <span class="n">ns</span><span class="o">.</span><span class="na">implicit_aliases_2</span> <span class="n">started</span> <span class="n">at</span> <span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">03</span> <span class="mi">16</span><span class="o">:</span><span class="mi">51</span><span class="o">:</span><span class="mi">50</span> <span class="n">and</span> <span class="n">finished</span> <span class="n">at</span> <span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">03</span> <span class="mi">16</span><span class="o">:</span><span class="mi">51</span><span class="o">:</span><span class="mi">50</span> <span class="n">successfully</span> <span class="n">affecting</span> <span class="mi">1</span> <span class="n">rows</span>
<span class="nc">Table</span> <span class="n">ns</span><span class="o">.</span><span class="na">alias_shadowing</span> <span class="n">started</span> <span class="n">at</span> <span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">03</span> <span class="mi">16</span><span class="o">:</span><span class="mi">51</span><span class="o">:</span><span class="mi">50</span> <span class="n">and</span> <span class="n">finished</span> <span class="n">at</span> <span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">03</span> <span class="mi">16</span><span class="o">:</span><span class="mi">51</span><span class="o">:</span><span class="mi">50</span> <span class="n">successfully</span> <span class="n">affecting</span> <span class="mi">1</span> <span class="n">rows</span>
<span class="nc">Table</span> <span class="n">ns</span><span class="o">.</span><span class="na">test_1</span> <span class="n">started</span> <span class="n">at</span> <span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">03</span> <span class="mi">16</span><span class="o">:</span><span class="mi">51</span><span class="o">:</span><span class="mi">50</span> <span class="n">and</span> <span class="n">finished</span> <span class="n">at</span> <span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">03</span> <span class="mi">16</span><span class="o">:</span><span class="mi">51</span><span class="o">:</span><span class="mi">50</span> <span class="n">successfully</span> <span class="n">affecting</span> <span class="mi">1</span> <span class="n">rows</span>
<span class="nc">Table</span> <span class="n">ns</span><span class="o">.</span><span class="na">implicit_aliases</span> <span class="n">started</span> <span class="n">at</span> <span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">03</span> <span class="mi">16</span><span class="o">:</span><span class="mi">51</span><span class="o">:</span><span class="mi">50</span> <span class="n">and</span> <span class="n">finished</span> <span class="n">at</span> <span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">03</span> <span class="mi">16</span><span class="o">:</span><span class="mi">51</span><span class="o">:</span><span class="mi">50</span> <span class="n">successfully</span> <span class="n">affecting</span> <span class="mi">0</span> <span class="n">rows</span>
<span class="nc">Table</span> <span class="n">ns</span><span class="o">.</span><span class="na">cte_shadowing</span> <span class="n">started</span> <span class="n">at</span> <span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">03</span> <span class="mi">16</span><span class="o">:</span><span class="mi">51</span><span class="o">:</span><span class="mi">50</span> <span class="n">and</span> <span class="n">finished</span> <span class="n">at</span> <span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">03</span> <span class="mi">16</span><span class="o">:</span><span class="mi">51</span><span class="o">:</span><span class="mi">50</span> <span class="n">successfully</span> <span class="n">affecting</span> <span class="mi">1</span> <span class="n">rows</span>
<span class="nc">Table</span> <span class="n">ns</span><span class="o">.</span><span class="na">cte_aliases</span> <span class="n">started</span> <span class="n">at</span> <span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">03</span> <span class="mi">16</span><span class="o">:</span><span class="mi">51</span><span class="o">:</span><span class="mi">50</span> <span class="n">and</span> <span class="n">finished</span> <span class="n">at</span> <span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">03</span> <span class="mi">16</span><span class="o">:</span><span class="mi">51</span><span class="o">:</span><span class="mi">50</span> <span class="n">successfully</span> <span class="n">affecting</span> <span class="mi">1</span> <span class="n">rows</span>
<span class="nc">Table</span> <span class="n">ns</span><span class="o">.</span><span class="na">aliases_where_clause</span> <span class="n">started</span> <span class="n">at</span> <span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">03</span> <span class="mi">16</span><span class="o">:</span><span class="mi">51</span><span class="o">:</span><span class="mi">50</span> <span class="n">and</span> <span class="n">finished</span> <span class="n">at</span> <span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">03</span> <span class="mi">16</span><span class="o">:</span><span class="mi">51</span><span class="o">:</span><span class="mi">50</span> <span class="n">successfully</span> <span class="n">affecting</span> <span class="mi">0</span> <span class="n">rows</span>
<span class="nc">Table</span> <span class="n">ns</span><span class="o">.</span><span class="na">src_bar</span> <span class="n">started</span> <span class="n">at</span> <span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">03</span> <span class="mi">16</span><span class="o">:</span><span class="mi">51</span><span class="o">:</span><span class="mi">50</span> <span class="n">and</span> <span class="n">finished</span> <span class="n">at</span> <span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">03</span> <span class="mi">16</span><span class="o">:</span><span class="mi">51</span><span class="o">:</span><span class="mi">50</span> <span class="n">successfully</span> <span class="n">affecting</span> <span class="mi">1</span> <span class="n">rows</span>
<span class="nc">Table</span> <span class="n">ns</span><span class="o">.</span><span class="na">src_foo</span> <span class="n">started</span> <span class="n">at</span> <span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">03</span> <span class="mi">16</span><span class="o">:</span><span class="mi">51</span><span class="o">:</span><span class="mi">50</span> <span class="n">and</span> <span class="n">finished</span> <span class="n">at</span> <span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">03</span> <span class="mi">16</span><span class="o">:</span><span class="mi">51</span><span class="o">:</span><span class="mi">50</span> <span class="n">successfully</span> <span class="n">affecting</span> <span class="mi">1</span> <span class="n">rows</span>
<span class="nc">Table</span> <span class="n">ns</span><span class="o">.</span><span class="na">zzz</span> <span class="n">started</span> <span class="n">at</span> <span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">03</span> <span class="mi">16</span><span class="o">:</span><span class="mi">51</span><span class="o">:</span><span class="mi">50</span> <span class="n">and</span> <span class="n">finished</span> <span class="n">at</span> <span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">03</span> <span class="mi">16</span><span class="o">:</span><span class="mi">51</span><span class="o">:</span><span class="mi">50</span> <span class="n">successfully</span> <span class="n">affecting</span> <span class="mi">100</span> <span class="n">rows</span>
</code></pre></div></div> <p><a name="napkin-history-GUID"></a></p> <ul> <li>
<code class="language-plaintext highlighter-rouge">GUID</code> parameter allows you to specify exact Napkin run to obtain information from. To see list of all runs, try <a href="#list"><code class="language-plaintext highlighter-rouge">napkin history list</code></a> command.</li> </ul> <p>If <code class="language-plaintext highlighter-rouge">GUID</code> parameter is omitted, <code class="language-plaintext highlighter-rouge">napkin history show</code> defaults it to the “last Napkin execution” (the same as in <code class="language-plaintext highlighter-rouge">git show</code>).</p> <h3 id="gantt">Gantt</h3> <p><code class="language-plaintext highlighter-rouge">napkin history gantt</code> command allows to export metadata about particular Napkin execution into a human-readable form with help of <a href="https://www.highcharts.com" target="_blank" rel="noopener noreferrer">Highcharts</a> HTML library.</p> <p class="text-delta text-center">shell</p> <div class="language-sh copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code>napkin <span class="nb">history </span>gantt <span class="nt">--help</span>
</code></pre></div></div> <div class="highlighter-rouge"><pre>Usage: napkin history gantt [GUID] [-o|--output-dir DIR]
  Exports Napkin run into a gantt chart. Uses latest run if ID wasn't provided

Available options:
  GUID                     GUID of the Napkin run
  <a href="#napkin-history--o,--output-dir">-o,--output-dir</a> DIR      Directory containing OUTPUT files
  <a href="#napkin--h,--help">-h,--help</a>                Show this help text

Global options:
  <a href="#napkin--s,--spec-file">-s,--spec-file</a> SPEC_YAML Path to the spec yaml file
                           (default: "specs/spec.yaml")
  <a href="#napkin--a,--app-name">-a,--app-name</a> APPLICATION-NAME
                           User's project or application name
  <a href="#napkin--Q,--metadata-connection-string">-Q,--metadata-connection-string</a> URI
                           An optional alternate connection string for tracking
                           napkin operations. Currently supports SQLite3 and
                           Postgres backends, e.g. sqlite:/some/file.sqlite3 or
                           postgresql://user@host
  <a href="#napkin--v,--verbose">-v,--verbose</a>             Print debug log
  <a href="#napkin--l,--log-level">-l,--log-level</a> LOG_LEVEL Log severity level. Possible values: Debug, Info,
                           Notice, Warning, Error, Critical, Alert, Emergency.
                           (default: Info)
  <a href="#napkin---log-format">--log-format</a> LOG_FORMAT  Log line format. Possible values: Simple, Server,
                           Json. (default: Simple)
</pre></div> <p><a name="napkin-history--o,--output-dir"></a></p> <ul> <li>
<code class="language-plaintext highlighter-rouge">-o</code>, <code class="language-plaintext highlighter-rouge">--output-dir</code> parameter points Napkin to the directory, which should be used for exporting HTML file with a Gantt chart. By default, current working directory will be used.</li> </ul> <p><code class="language-plaintext highlighter-rouge">napkin history gantt</code> command exports metadata of the specified Napkin run to the <code class="language-plaintext highlighter-rouge">DIR</code> directory in the form of Gantt chart (HTML page).</p> <p class="text-delta text-center">shell</p> <div class="language-sh copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code>napkin <span class="nb">history </span>gantt 7a554ca7-61dc-4884-9d06-a4614c9e2827 <span class="nt">-o</span> data/
</code></pre></div></div> <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Gantt chart generated: data/gantt_napkin_7a554ca7-61dc-4884-9d06-a4614c9e2827.html
</code></pre></div></div> <p>For example:</p> <iframe style="border: none;" src="/user-manual/gantt.html" width="100%" height="650"></iframe> <p>If <code class="language-plaintext highlighter-rouge">GUID</code> parameter is omitted, <code class="language-plaintext highlighter-rouge">napkin history gantt</code> defaults it to the “last Napkin execution” (the same as in <code class="language-plaintext highlighter-rouge">git show</code>).</p> <h2 id="validate">Validate</h2> <p><code class="language-plaintext highlighter-rouge">napkin validate</code> command allows to check the whole spec for:</p> <ul> <li>Napkin’s ability to correctly parse and process all the sql files.</li> <li>Napkin’s ability to compile and execute parts of the specs defined in Haskell.</li> <li>Validity of the built-in and user-defined <a href="/user-manual/preprocessors/">preprocessors</a>.</li> <li>Validity of the settings inside <a href="/user-manual/yaml-reference/">spec.yaml</a> file.</li> <li>Correctness of <a href="/user-manual/mustache/">mustache interpolation</a> instructions.</li> <li>Absence of dependency loops across table definitions.</li> </ul> <p>It is a good idea to check for the spec validness before committing the changes to the source code repository (git), so that other team members will not be surprised that <code class="language-plaintext highlighter-rouge">napkin run</code> is unable for do it’s job.</p> <p class="text-delta text-center">shell</p> <div class="language-sh copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code>napkin validate <span class="nt">--help</span>
</code></pre></div></div> <div class="highlighter-rouge"><pre>Usage: napkin validate [-s|--spec-file SPEC_YAML] 
                       [--override /json/pointer={"json": "value"}] 
                       [-i|--interactive] [-r|--rolling] [-S|--strict-mustache] 
                       [--arg ARG=VALUE | --arg-json JSON | --arg-file FILE]
  Validates YAML spec file

Available options:
  <a href="#napkin--s,--spec-file">-s,--spec-file</a> SPEC_YAML Path to the spec yaml file
                           (default: "specs/spec.yaml")
  <a href="#napkin---override">--override</a> /json/pointer={"json": "value"}
                           Set arbitrary JSON pointer (RFC 6901) in YAML spec
                           with the new value
  <a href="#napkin-validate--i,--interactive">-i,--interactive</a>         Watches for changed files and constantly revalidates
  <a href="#napkin-validate--r,--rolling">-r,--rolling</a>             Does not clear the screen in live validation mode
  <a href="#napkin--S,--strict-mustache">-S,--strict-mustache</a>     Strict mustache validation mode
  <a href="#napkin---arg">--arg</a> ARG=VALUE          Argument to be passed to spec
  <a href="#napkin---arg-json">--arg-json</a> JSON          Spec arguments encoded as JSON object
  <a href="#napkin---arg-file">--arg-file</a> FILE          Spec arguments stored in JSON file
  <a href="#napkin--h,--help">-h,--help</a>                Show this help text

Global options:
  <a href="#napkin--v,--verbose">-v,--verbose</a>             Print debug log
  <a href="#napkin--l,--log-level">-l,--log-level</a> LOG_LEVEL Log severity level. Possible values: Debug, Info,
                           Notice, Warning, Error, Critical, Alert, Emergency.
                           (default: Info)
  <a href="#napkin---log-format">--log-format</a> LOG_FORMAT  Log line format. Possible values: Simple, Server,
                           Json. (default: Simple)
</pre></div> <p><a name="napkin-validate--i,--interactive"></a></p> <ul> <li>In <code class="language-plaintext highlighter-rouge">-i</code>, <code class="language-plaintext highlighter-rouge">--interactive</code> mode, Napkin constantly monitors all the files and folders, mentioned in <a href="/user-manual/yaml-reference/">spec.yaml</a> file automatically re-validates the spec on any change. It is convenient to have <code class="language-plaintext highlighter-rouge">napkin validate --interactive</code> process opened in a separate window, while you are working on the SQL files or the <a href="/user-manual/yaml-reference/">spec.yaml</a> definition. <a name="napkin-validate--r,--rolling"></a>
</li> <li>By default, <code class="language-plaintext highlighter-rouge">--interactive</code> mode clears the screen before each validation cycle. To switch that feature off, you can use <code class="language-plaintext highlighter-rouge">-r</code>, <code class="language-plaintext highlighter-rouge">--rolling</code> mode, in which Napkin will constantly append validation status and error messages (in any) to the end of the output. <a name="napkin--S,--strict-mustache"></a>
</li> <li>Napkin has number of strict mustache validation checks, which are not enabled by default. Use <code class="language-plaintext highlighter-rouge">-S</code>, <code class="language-plaintext highlighter-rouge">--strict-mustache</code> flag to enable additional checks (see <a href="/user-manual/mustache/">mustache interpolation</a> for details).</li> </ul> <p>Without <code class="language-plaintext highlighter-rouge">--interactive</code> mode, napkin will print the single <code class="language-plaintext highlighter-rouge">OK</code> message to the terminal and exit with 0 exit code.</p> <p class="text-delta text-center">shell</p> <div class="language-sh copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code>napkin validate <span class="nt">-s</span> specs/spec.yaml
</code></pre></div></div> <p class="text-delta text-center">output</p> <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>OK
</code></pre></div></div> <p>With <code class="language-plaintext highlighter-rouge">--interactive</code> mode, Napkin constantly monitors for the changes in all files mentioned in the <a href="/user-manual/yaml-reference/">spec.yaml</a> and re-validates as soon as it sees a change.</p> <p><a href="https://asciinema.org/a/8pbkK83DuAbhzE8w1OsWO9l0d" target="_blank" rel="noopener noreferrer"><img src="https://asciinema.org/a/8pbkK83DuAbhzE8w1OsWO9l0d.svg" alt="asciicast"></a></p> <h2 id="dump">Dump</h2> <p>Besides knowing that your spec is “OK” (by using <code class="language-plaintext highlighter-rouge">napkin validate</code> command), Napkin also provides a way to see SQL queries, which Napkin would execute on a real database engine in by using <code class="language-plaintext highlighter-rouge">napkin run</code> command.</p> <p class="text-delta text-center">shell</p> <div class="language-sh copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code>napkin dump <span class="nt">--help</span>
</code></pre></div></div> <div class="highlighter-rouge"><pre>Usage: napkin dump [-s|--spec-file SPEC_YAML] 
                   [--override /json/pointer={"json": "value"}] 
                   [--arg ARG=VALUE | --arg-json JSON | --arg-file FILE] 
                   [-o|--output-dir DIR] [-f|--force] [-i|--generate-inserts] 
                   [-e|--exclude-unmanaged-tables] [-S|--strict-mustache] 
                   [--use-spec-names]
  Performs a dry run and stores queries for inspection

Available options:
  <a href="#napkin--s,--spec-file">-s,--spec-file</a> SPEC_YAML Path to the spec yaml file
                           (default: "specs/spec.yaml")
  <a href="#napkin---override">--override</a> /json/pointer={"json": "value"}
                           Set arbitrary JSON pointer (RFC 6901) in YAML spec
                           with the new value
  <a href="#napkin---arg">--arg</a> ARG=VALUE          Argument to be passed to spec
  <a href="#napkin---arg-json">--arg-json</a> JSON          Spec arguments encoded as JSON object
  <a href="#napkin---arg-file">--arg-file</a> FILE          Spec arguments stored in JSON file
  <a href="#napkin-dump--o,--output-dir">-o,--output-dir</a> DIR      Directory containing OUTPUT files (default: "dump")
  <a href="#napkin-dump--f,--force">-f,--force</a>               Force write to destination directory
  <a href="#napkin-dump--i,--generate-inserts">-i,--generate-inserts</a>    Generate inserts for tables instead of simply dumping
                           the query
  <a href="#napkin-dump--e,--exclude-unmanaged-tables">-e,--exclude-unmanaged-tables</a>
                           Show only managed tables in the DOT graph exclusively
  <a href="#napkin--S,--strict-mustache">-S,--strict-mustache</a>     Strict mustache validation mode
  <a href="#napkin-dump---use-spec-names">--use-spec-names</a>         Use unprocessed table names as filenames
  <a href="#napkin--h,--help">-h,--help</a>                Show this help text

Global options:
  <a href="#napkin--v,--verbose">-v,--verbose</a>             Print debug log
  <a href="#napkin--l,--log-level">-l,--log-level</a> LOG_LEVEL Log severity level. Possible values: Debug, Info,
                           Notice, Warning, Error, Critical, Alert, Emergency.
                           (default: Info)
  <a href="#napkin---log-format">--log-format</a> LOG_FORMAT  Log line format. Possible values: Simple, Server,
                           Json. (default: Simple)
</pre></div> <p><a name="napkin-dump--o,--output-dir"></a></p> <ul> <li>
<code class="language-plaintext highlighter-rouge">-o</code>, <code class="language-plaintext highlighter-rouge">--output-dir</code> parameter is used to specify output directory to put SQL files into. Directory will also contain dependency diagram (in form of <code class="language-plaintext highlighter-rouge">.dot</code> and <code class="language-plaintext highlighter-rouge">.pdf</code> files) between the tables. <a name="napkin-dump--f,--force"></a>
</li> <li>
<code class="language-plaintext highlighter-rouge">-f</code>, <code class="language-plaintext highlighter-rouge">--force</code> flag is used to indicate, that it is OK for Napkin to override target directory. <a name="napkin-dump--e,--exclude-unmanaged-tables"></a>
</li> <li>By default, Napkin will add both managed and unmanaged tabled into a dependency diagram. <code class="language-plaintext highlighter-rouge">-e</code>, <code class="language-plaintext highlighter-rouge">--exclude-unmanaged-tables</code> flag forces Napkin to only include managed tables. <a name="napkin-dump--i,--generate-inserts"></a>
</li> <li>
<code class="language-plaintext highlighter-rouge">-i</code>, <code class="language-plaintext highlighter-rouge">--generate-inserts</code> flag forces Napkin to generate SQL queries in form of <code class="language-plaintext highlighter-rouge">INSERT INTO __TABLE_NAME__ SELECT ...</code> instead of default <code class="language-plaintext highlighter-rouge">SELECT ...</code> <a name="napkin-dump---use-spec-names"></a>
</li> <li>with <code class="language-plaintext highlighter-rouge">--use-spec-names</code> Napkin will use original table names (as declared in <a href="/user-manual/yaml-reference/">spec.yaml</a>) for the file names in dump output. Otherwise, file names are equal to the table names after applying <a href="/user-manual/preprocessors/">preprocessors</a>.</li> </ul> <p>Usually <code class="language-plaintext highlighter-rouge">napkin dump</code> command will create following directory structure:</p> <p class="text-delta text-center">shell</p> <div class="language-sh copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code>napkin dump <span class="nt">-o</span> dump
</code></pre></div></div> <p class="text-delta text-center">output</p> <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dump
├── 01_update_daily.sql
├── 02_update_on_upstream.sql
├── 03_random.sql
├── 04_first_run_at.sql
├── 05_total_sales_by_year.sql
├── 06_long_to_wide.1.sql
├── 06_long_to_wide.2.sql
├── 07_day_totals_2.create_1.sql
├── 07_day_totals_2.update_1.sql
├── 08_day_totals_1.create_1.sql
├── 08_day_totals_1.create_2.sql
├── 08_day_totals_1.update_1.sql
├── 09_day_totals.create_1.sql
├── 09_day_totals.create_2.sql
├── 09_day_totals.update_1.sql
├── 10_artist_hex.sql
├── 11_popular_tracks_for_pink_floyd.sql
├── 12_artist_track_count_view.sql
├── 13_artist_track_count.sql
├── 14_artist_track_count_2.sql
├── 15_artist_album_count_via_mustache_2.sql
├── 16_artist_album_count_via_mustache.sql
├── 17_artist_album_count.sql
├── MANIFEST.txt
├── dependency_graph.dot
└── dependency_graph.pdf
</code></pre></div></div> <div class="premonition note"> <i class="premonition pn-note"></i> <div class="content"> <p>Some source sql files, like <code class="language-plaintext highlighter-rouge">day_totals.sql</code> will produce multiple output files:</p> <ul> <li>
<code class="language-plaintext highlighter-rouge">09_day_totals.create_1.sql</code>, <code class="language-plaintext highlighter-rouge">09_day_totals.create_2.sql</code> – queries Napkin would execute in order to create <code class="language-plaintext highlighter-rouge">day_totals</code> table is it is not exists yet.</li> <li>
<code class="language-plaintext highlighter-rouge">09_day_totals.update_1.sql</code> – query Napkin would execute in order to update already existing <code class="language-plaintext highlighter-rouge">day_totals</code> table.</li> </ul> </div> </div> <p>Along with output SQL files, <code class="language-plaintext highlighter-rouge">napkin dump</code> command also generates dependency diagram between the tables in <a href="https://graphviz.org" target="_blank" rel="noopener noreferrer">Graphviz</a> format:</p> <p class="text-delta text-center">graph</p> <div class="language-dot highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">digraph</span> <span class="p">{</span>
    <span class="mi">1</span> <span class="o">[</span><span class="n">label</span><span class="p">=</span><span class="nv">Album</span>
      <span class="p">,</span><span class="n">shape</span><span class="p">=</span><span class="nv">box</span>
      <span class="p">,</span><span class="n">style</span><span class="p">=</span><span class="nv">dotted</span><span class="o">]</span><span class="p">;</span>
    <span class="mi">2</span> <span class="o">[</span><span class="n">label</span><span class="p">=</span><span class="nv">Artist</span>
      <span class="p">,</span><span class="n">shape</span><span class="p">=</span><span class="nv">box</span>
      <span class="p">,</span><span class="n">style</span><span class="p">=</span><span class="nv">dotted</span><span class="o">]</span><span class="p">;</span>
    <span class="mi">3</span> <span class="o">[</span><span class="n">label</span><span class="p">=</span><span class="nv">InvoiceLine</span>
      <span class="p">,</span><span class="n">shape</span><span class="p">=</span><span class="nv">box</span>
      <span class="p">,</span><span class="n">style</span><span class="p">=</span><span class="nv">dotted</span><span class="o">]</span><span class="p">;</span>
    <span class="mi">4</span> <span class="o">[</span><span class="n">label</span><span class="p">=</span><span class="nv">Track</span>
      <span class="p">,</span><span class="n">shape</span><span class="p">=</span><span class="nv">box</span>
      <span class="p">,</span><span class="n">style</span><span class="p">=</span><span class="nv">dotted</span><span class="o">]</span><span class="p">;</span>
    <span class="mi">5</span> <span class="o">[</span><span class="n">label</span><span class="p">=</span><span class="nv">artist_album_count</span>
      <span class="p">,</span><span class="n">fillcolor</span><span class="p">=</span><span class="s2">"#59a14f"</span>
      <span class="p">,</span><span class="n">fontcolor</span><span class="p">=</span><span class="s2">"#ffffff"</span>
      <span class="p">,</span><span class="n">style</span><span class="p">=</span><span class="nv">filled</span><span class="o">]</span><span class="p">;</span>
    <span class="mi">6</span> <span class="o">[</span><span class="n">label</span><span class="p">=</span><span class="nv">artist_album_count_via_mustache</span>
      <span class="p">,</span><span class="n">fillcolor</span><span class="p">=</span><span class="s2">"#edc948"</span>
      <span class="p">,</span><span class="n">fontcolor</span><span class="p">=</span><span class="s2">"#000000"</span>
      <span class="p">,</span><span class="n">style</span><span class="p">=</span><span class="nv">filled</span><span class="o">]</span><span class="p">;</span>
    <span class="mi">7</span> <span class="o">[</span><span class="n">label</span><span class="p">=</span><span class="nv">artist_album_count_via_mustache_2</span>
      <span class="p">,</span><span class="n">fillcolor</span><span class="p">=</span><span class="s2">"#b07aa1"</span>
      <span class="p">,</span><span class="n">fontcolor</span><span class="p">=</span><span class="s2">"#ffffff"</span>
      <span class="p">,</span><span class="n">style</span><span class="p">=</span><span class="nv">filled</span><span class="o">]</span><span class="p">;</span>
    <span class="mi">8</span> <span class="o">[</span><span class="n">label</span><span class="p">=</span><span class="nv">artist_hex</span>
      <span class="p">,</span><span class="n">fillcolor</span><span class="p">=</span><span class="s2">"#4e79a7"</span>
      <span class="p">,</span><span class="n">fontcolor</span><span class="p">=</span><span class="s2">"#ffffff"</span>
      <span class="p">,</span><span class="n">style</span><span class="p">=</span><span class="nv">filled</span><span class="o">]</span><span class="p">;</span>
    <span class="mi">9</span> <span class="o">[</span><span class="n">label</span><span class="p">=</span><span class="nv">artist_track_count</span>
      <span class="p">,</span><span class="n">fillcolor</span><span class="p">=</span><span class="s2">"#f28e2b"</span>
      <span class="p">,</span><span class="n">fontcolor</span><span class="p">=</span><span class="s2">"#000000"</span>
      <span class="p">,</span><span class="n">style</span><span class="p">=</span><span class="nv">filled</span><span class="o">]</span><span class="p">;</span>
    <span class="mi">10</span> <span class="o">[</span><span class="n">label</span><span class="p">=</span><span class="nv">artist_track_count_2</span>
       <span class="p">,</span><span class="n">fillcolor</span><span class="p">=</span><span class="s2">"#e15759"</span>
       <span class="p">,</span><span class="n">fontcolor</span><span class="p">=</span><span class="s2">"#ffffff"</span>
       <span class="p">,</span><span class="n">style</span><span class="p">=</span><span class="nv">filled</span><span class="o">]</span><span class="p">;</span>
    <span class="mi">11</span> <span class="o">[</span><span class="n">label</span><span class="p">=</span><span class="nv">artist_track_count_view</span>
       <span class="p">,</span><span class="n">fillcolor</span><span class="p">=</span><span class="s2">"#76b7b2"</span>
       <span class="p">,</span><span class="n">fontcolor</span><span class="p">=</span><span class="s2">"#000000"</span>
       <span class="p">,</span><span class="n">style</span><span class="p">=</span><span class="nv">filled</span><span class="o">]</span><span class="p">;</span>
    <span class="mi">12</span> <span class="o">[</span><span class="n">label</span><span class="p">=</span><span class="nv">popular_tracks_for_pink_floyd</span>
       <span class="p">,</span><span class="n">fillcolor</span><span class="p">=</span><span class="s2">"#59a14f"</span>
       <span class="p">,</span><span class="n">fontcolor</span><span class="p">=</span><span class="s2">"#ffffff"</span>
       <span class="p">,</span><span class="n">style</span><span class="p">=</span><span class="nv">filled</span><span class="o">]</span><span class="p">;</span>
    <span class="mi">1</span> <span class="o">-&gt;</span> <span class="mi">5</span><span class="p">;</span>
    <span class="mi">1</span> <span class="o">-&gt;</span> <span class="mi">6</span><span class="p">;</span>
    <span class="mi">1</span> <span class="o">-&gt;</span> <span class="mi">7</span><span class="p">;</span>
    <span class="mi">1</span> <span class="o">-&gt;</span> <span class="mi">9</span><span class="p">;</span>
    <span class="mi">1</span> <span class="o">-&gt;</span> <span class="mi">11</span><span class="p">;</span>
    <span class="mi">1</span> <span class="o">-&gt;</span> <span class="mi">12</span><span class="p">;</span>
    <span class="mi">2</span> <span class="o">-&gt;</span> <span class="mi">5</span><span class="p">;</span>
    <span class="mi">2</span> <span class="o">-&gt;</span> <span class="mi">6</span><span class="p">;</span>
    <span class="mi">2</span> <span class="o">-&gt;</span> <span class="mi">7</span><span class="p">;</span>
    <span class="mi">2</span> <span class="o">-&gt;</span> <span class="mi">8</span><span class="p">;</span>
    <span class="mi">2</span> <span class="o">-&gt;</span> <span class="mi">9</span><span class="p">;</span>
    <span class="mi">2</span> <span class="o">-&gt;</span> <span class="mi">11</span><span class="p">;</span>
    <span class="mi">2</span> <span class="o">-&gt;</span> <span class="mi">12</span><span class="p">;</span>
    <span class="mi">3</span> <span class="o">-&gt;</span> <span class="mi">12</span><span class="p">;</span>
    <span class="mi">4</span> <span class="o">-&gt;</span> <span class="mi">9</span><span class="p">;</span>
    <span class="mi">4</span> <span class="o">-&gt;</span> <span class="mi">11</span><span class="p">;</span>
    <span class="mi">4</span> <span class="o">-&gt;</span> <span class="mi">12</span><span class="p">;</span>
    <span class="mi">9</span> <span class="o">-&gt;</span> <span class="mi">10</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <p>In PDF format, this diagram (<a href="/user-manual/cli-reference/dependency_graph.pdf" target="_blank">download</a>) looks like that:</p> <p><img src="/user-manual/cli-reference/dependency_graph.svg" alt="dependency_graph"></p> <h2 id="optimize">Optimize</h2> <p>The command combines a set of features for discovery and fixing semantic issues with SQL queries or spec itself.</p> <h3 id="unused-cte-column">Unused CTE column</h3> <p>CTE is a named subquery introduced with <strong>WITH</strong> keyword.</p> <p>In a complex query comprised of many CTE subqueries a user might forget to remove helper column just after debugging and the column remains in the query and contributes to spec running costs.</p> <p class="text-delta text-center">table_a2.sql</p> <div class="language-sql copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">with</span> <span class="n">cte</span> <span class="k">as</span> <span class="p">(</span><span class="k">select</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="k">from</span> <span class="n">t</span><span class="p">)</span> <span class="k">select</span> <span class="n">b</span> <span class="k">from</span> <span class="n">cte</span>
</code></pre></div></div> <p class="text-delta text-center">shell</p> <div class="language-sh copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code>napkin optimize <span class="nt">-s</span> specs/spec.yaml
</code></pre></div></div> <div class="highlighter-rouge"><pre>
Table: tbl_b2 (table_a2.sql)
   unused column cte.a
</pre></div> <h3 id="duplicated-cte">Duplicated CTE</h3> <p>This optimization aims equivalent CTEs defined in the same query.</p> <p class="text-delta text-center">table_a2.sql</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">with</span> <span class="n">cte1</span> <span class="k">as</span> <span class="p">(</span><span class="k">select</span> <span class="n">a</span> <span class="k">from</span> <span class="n">t</span> <span class="k">where</span> <span class="n">b</span><span class="o">*</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">),</span>
     <span class="n">cte2</span> <span class="k">as</span> <span class="p">(</span><span class="k">select</span> <span class="n">a</span> <span class="k">from</span> <span class="n">t</span> <span class="k">where</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
     <span class="k">select</span> <span class="n">b</span> <span class="k">from</span> <span class="n">t2</span> <span class="k">where</span> <span class="n">a1</span> <span class="k">in</span> <span class="n">cte1</span> <span class="k">or</span> <span class="n">a2</span> <span class="k">in</span> <span class="n">cte2</span>
</code></pre></div></div> <div class="highlighter-rouge"><pre>
Table: tbl_b2 (table_a2.sql)
   duplicated CTE tables: cte1, cte2
</pre></div> <p>By default optimize just prints discovered issues, though it is possible to ask Napkin to resolve the issues automatically. Automatic refactoring doesn’t preserve original SQL formatting. SQL based optimizer is supported only by generic dialect.</p> <p class="text-delta text-center">shell</p> <div class="language-sh copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code>napkin optimize <span class="nt">--help</span>
</code></pre></div></div> <div class="highlighter-rouge"><pre>Usage: napkin optimize [-s|--spec-file SPEC_YAML] [--mode ARG] [--selector ARG] 
                       [-S|--strict-mustache] 
                       [--arg ARG=VALUE | --arg-json JSON | --arg-file FILE]
  Discovers unused CTE columns in spec queries

Available options:
  <a href="#napkin--s,--spec-file">-s,--spec-file</a> SPEC_YAML Path to the spec yaml file
                           (default: "specs/spec.yaml")
  <a href="#napkin-optimize---mode">--mode</a> ARG               Mode for running optimizations. Could be:
                           show-issues, interactive (default: show-issues)
  <a href="#napkin-optimize---selector">--selector</a> ARG           Optimization feature selector. By default all
                           optimizations are on: unused-columns,
                           duplicated-queries. To turn on extra feature use "+"
                           prefix to remove feature "-" prefix and to run just
                           specific features don't use any prefix.
  <a href="#napkin--S,--strict-mustache">-S,--strict-mustache</a>     Strict mustache validation mode
  <a href="#napkin---arg">--arg</a> ARG=VALUE          Argument to be passed to spec
  <a href="#napkin---arg-json">--arg-json</a> JSON          Spec arguments encoded as JSON object
  <a href="#napkin---arg-file">--arg-file</a> FILE          Spec arguments stored in JSON file
  <a href="#napkin--h,--help">-h,--help</a>                Show this help text

Global options:
  <a href="#napkin--v,--verbose">-v,--verbose</a>             Print debug log
  <a href="#napkin--l,--log-level">-l,--log-level</a> LOG_LEVEL Log severity level. Possible values: Debug, Info,
                           Notice, Warning, Error, Critical, Alert, Emergency.
                           (default: Info)
  <a href="#napkin---log-format">--log-format</a> LOG_FORMAT  Log line format. Possible values: Simple, Server,
                           Json. (default: Simple)
</pre></div> <p><a name="napkin-optimize---mode"></a></p> <ul> <li>
<code class="language-plaintext highlighter-rouge">--mode</code> TODO <a name="napkin-optimize---selector"></a>
</li> <li>
<code class="language-plaintext highlighter-rouge">--selector</code> TODO</li> </ul> <h2 id="haddock">Haddock</h2> <p class="text-delta text-center">shell</p> <div class="language-sh copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code>napkin haddock <span class="nt">--help</span>
</code></pre></div></div> <div class="highlighter-rouge"><pre>Usage: napkin haddock 
  Opens web page with Napkin haddocks

Available options:
  <a href="#napkin--h,--help">-h,--help</a>                Show this help text

Global options:
  <a href="#napkin--v,--verbose">-v,--verbose</a>             Print debug log
  <a href="#napkin--l,--log-level">-l,--log-level</a> LOG_LEVEL Log severity level. Possible values: Debug, Info,
                           Notice, Warning, Error, Critical, Alert, Emergency.
                           (default: Info)
  <a href="#napkin---log-format">--log-format</a> LOG_FORMAT  Log line format. Possible values: Simple, Server,
                           Json. (default: Simple)
</pre></div> <p>Napkin is written in Haskell and currently exposes all internal APIs for external use (as it allows meta-programming, expressing SQL statements programmatically, etc.).</p> <p>Links to the Napkin Haskell API documentation for each individual version can be found <a href="/haddock/">here</a>.</p> <p>You can always “ask” Napkin CLI for the exact link to the API reference for the currently installed version. It will open a browser with an API docs for the exact git commit SHA Napkin was built from.</p> <p class="text-delta text-center">shell</p> <div class="language-sh copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code>napkin haddock <span class="nt">--log-level</span> Debug
</code></pre></div></div> <p class="text-delta text-center">output</p> <div class="language-java text-wrap highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Opening</span> <span class="s">"http://soostone-napkin-public.s3-website.us-east-1.amazonaws.com/haddock/git-hash/a8811868647ccc54e5c716e1a2781fe1c8b2ef9b/index.html"</span> <span class="no">URL</span> <span class="n">in</span> <span class="n">the</span> <span class="n">browser</span>
</code></pre></div></div> <iframe style="border: none;" src="https://soostone-napkin-public.s3.us-east-1.amazonaws.com/haddock/git-hash/a8811868647ccc54e5c716e1a2781fe1c8b2ef9b/index.html" width="100%" height="650"></iframe> <h2 id="docs">Docs</h2> <p class="text-delta text-center">shell</p> <div class="language-sh copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code>napkin docs <span class="nt">--help</span>
</code></pre></div></div> <div class="highlighter-rouge"><pre>Usage: napkin docs 
  Opens web page with Napkin tutorial

Available options:
  <a href="#napkin--h,--help">-h,--help</a>                Show this help text

Global options:
  <a href="#napkin--v,--verbose">-v,--verbose</a>             Print debug log
  <a href="#napkin--l,--log-level">-l,--log-level</a> LOG_LEVEL Log severity level. Possible values: Debug, Info,
                           Notice, Warning, Error, Critical, Alert, Emergency.
                           (default: Info)
  <a href="#napkin---log-format">--log-format</a> LOG_FORMAT  Log line format. Possible values: Simple, Server,
                           Json. (default: Simple)
</pre></div> <p>As well as for <a href="#haddock">Haddock</a> API reference, Napkin CLI can be asked for a link to this documentation site.</p> <p class="text-delta text-center">shell</p> <div class="language-sh copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code>napkin docs <span class="nt">--log-level</span> Debug
</code></pre></div></div> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Opening</span> <span class="s">"https://soostone.github.io/tutorial/"</span> <span class="no">URL</span> <span class="n">in</span> <span class="n">the</span> <span class="n">browser</span>
</code></pre></div></div> <h2 id="repl">REPL</h2> <p><code class="language-plaintext highlighter-rouge">napkin repl</code> can be useful when using advanced meta-programming features. When this command is used Napkin will spawn Haskell <a href="https://wiki.haskell.org/GHC/GHCi" target="_blank" rel="noopener noreferrer">GHCI</a> session. Spec file has to be provided, so the REPL session will be configured appropriately.</p> <p class="text-delta text-center">shell</p> <div class="language-sh copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code>napkin run <span class="nt">--help</span>
</code></pre></div></div> <div class="highlighter-rouge"><pre>Usage: napkin repl [-s|--spec-file SPEC_YAML]
  Drops into Napkin repl

Available options:
  <a href="#napkin--s,--spec-file">-s,--spec-file</a> SPEC_YAML Path to the spec yaml file
                           (default: "specs/spec.yaml")
  <a href="#napkin--h,--help">-h,--help</a>                Show this help text

Global options:
  <a href="#napkin--v,--verbose">-v,--verbose</a>             Print debug log
  <a href="#napkin--l,--log-level">-l,--log-level</a> LOG_LEVEL Log severity level. Possible values: Debug, Info,
                           Notice, Warning, Error, Critical, Alert, Emergency.
                           (default: Info)
  <a href="#napkin---log-format">--log-format</a> LOG_FORMAT  Log line format. Possible values: Simple, Server,
                           Json. (default: Simple)
</pre></div> <h2 id="yaml-schema">Yaml-Schema</h2> <p class="text-delta text-center">shell</p> <div class="language-sh copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code>napkin yaml-schema <span class="nt">--help</span>
</code></pre></div></div> <div class="highlighter-rouge"><pre>Usage: napkin yaml-schema OUTPUT
  Stores YAML schema in a file

Available options:
  <a href="#napkin-yaml-schema-OUTPUT">OUTPUT</a>                   Name of the file to put generated yaml schema
  <a href="#napkin--h,--help">-h,--help</a>                Show this help text

Global options:
  <a href="#napkin--v,--verbose">-v,--verbose</a>             Print debug log
  <a href="#napkin--l,--log-level">-l,--log-level</a> LOG_LEVEL Log severity level. Possible values: Debug, Info,
                           Notice, Warning, Error, Critical, Alert, Emergency.
                           (default: Info)
  <a href="#napkin---log-format">--log-format</a> LOG_FORMAT  Log line format. Possible values: Simple, Server,
                           Json. (default: Simple)
</pre></div> <p>Many modern text editors and IDEs have (either native or through plugins) support for YAML Schema to enhance the process of editing complex YAML files. Napkin provides a way to export YAML schema to an external file - so it is possible to configure your editor properly.</p> <p>In addition, if your editor or plugin supports that feature, you can point it to the <a href="http://soostone-napkin-public.s3-website.us-east-1.amazonaws.com/schema/schema.json" target="_blank" rel="noopener noreferrer">web link</a> with a latest YAML schema. YAML schemas for previous releases can be found <a href="http://soostone-napkin-public.s3-website.us-east-1.amazonaws.com#schema/" target="_blank" rel="noopener noreferrer">here</a>.</p> <p><a name="napkin-yaml-schema-OUTPUT"></a></p> <ul> <li>
<code class="language-plaintext highlighter-rouge">OUTPUT</code> parameter is a path to a file to put generate yaml schema for the <a href="/user-manual/yaml-reference/">spec.yaml</a> config.</li> </ul> <p>For example:</p> <p class="text-delta text-center">shell</p> <div class="language-sh copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code>napkin yaml-schema <span class="nv">$HOME</span>/napkin.schema
</code></pre></div></div> <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Saving YAML schema to a file: /Users/user/napkin.schema
</code></pre></div></div> <h2 id="hie-bios">Hie-Bios</h2> <p class="text-delta text-center">shell</p> <div class="language-sh copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code>napkin hie-bios <span class="nt">--help</span>
</code></pre></div></div> <div class="highlighter-rouge"><pre>Usage: napkin hie-bios [-s|--spec-file SPEC_YAML] [GHC_OPTIONS]
  Used by Haskell Language Server

Available options:
  <a href="#napkin--s,--spec-file">-s,--spec-file</a> SPEC_YAML Path to the spec yaml file
                           (default: "specs/spec.yaml")
  <a href="#napkin-hie-bios-GHC_OPTIONS">GHC_OPTIONS</a>              List of extra GHC arguments to pass
  <a href="#napkin--h,--help">-h,--help</a>                Show this help text

Global options:
  <a href="#napkin--v,--verbose">-v,--verbose</a>             Print debug log
  <a href="#napkin--l,--log-level">-l,--log-level</a> LOG_LEVEL Log severity level. Possible values: Debug, Info,
                           Notice, Warning, Error, Critical, Alert, Emergency.
                           (default: Info)
  <a href="#napkin---log-format">--log-format</a> LOG_FORMAT  Log line format. Possible values: Simple, Server,
                           Json. (default: Simple)
</pre></div> <p><code class="language-plaintext highlighter-rouge">napkin hie-bios</code> provides support for advanced <a href="/user-manual/ide/#metaprogramming-haskell-language-server">meta-programming</a> with Napkin. This command is not supposed to be used directly by the user.</p> <p><a href="https://haskell-language-server.readthedocs.io/en/latest/" target="_blank" rel="noopener noreferrer">Haskell Language Server</a> <a href="https://github.com/haskell/hie-bios/blob/1875bff093983a0506f80e214eda27e7419da3bc/src/HIE/Bios/Cradle.hs#L838" target="_blank" rel="noopener noreferrer">sets</a> <code class="language-plaintext highlighter-rouge">HIE_BIOS_OUTPUT</code> environment variable, which is used by Napkin as a file name to write all inferred and <a href="#napkin-hie-bios-HIE_BIOS_OUTPUT">user-supplied</a> options to. For debug purposes, Napkin defaults file location to <code class="language-plaintext highlighter-rouge">hie-bios.txt</code> in the current working directory.</p> <p class="text-delta text-center">shell</p> <div class="language-sh copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">HIE_BIOS_OUTPUT</span><span class="o">=</span>/dev/tty napkin hie-bios <span class="nt">-s</span> specs/spec.yaml
</code></pre></div></div> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">...</span>
<span class="o">-</span><span class="kn">package</span>
<span class="nn">containers</span>
<span class="o">-</span><span class="kn">package</span>
<span class="nn">napkin</span>
<span class="o">-</span><span class="kn">package</span>
<span class="nn">ordered</span><span class="o">-</span><span class="n">containers</span>
<span class="o">-</span><span class="kn">package</span>
<span class="nn">unordered</span><span class="o">-</span><span class="n">containers</span>
<span class="o">-</span><span class="kn">package</span>
<span class="nn">text</span>
<span class="o">-</span><span class="kn">package</span>
<span class="nn">containers</span>
<span class="o">-</span><span class="kn">package</span>
<span class="nn">aeson</span>
<span class="o">...</span>
<span class="o">-</span><span class="nc">XBangPatterns</span>
<span class="o">-</span><span class="nc">XBinaryLiterals</span>
<span class="o">-</span><span class="nc">XConstrainedClassMethods</span>
<span class="o">-</span><span class="nc">XConstraintKinds</span>
<span class="o">-</span><span class="nc">XDeriveDataTypeable</span>
<span class="o">-</span><span class="nc">XDeriveFoldable</span>
<span class="o">...</span>
</code></pre></div></div> <p>Usually, it is enough to add the <code class="language-plaintext highlighter-rouge">hie.yaml</code> to the root of the Napkin project for the HLS plugin from your editor to load.</p> <p class="text-delta text-center">hie.yaml</p> <div class="language-yaml copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">cradle</span><span class="pi">:</span>
  <span class="na">bios</span><span class="pi">:</span>
    <span class="na">shell</span><span class="pi">:</span> <span class="s">napkin hie-bios --spec-file specs/spec.yaml</span>
</code></pre></div></div> <p><a name="napkin-hie-bios-GHC_OPTIONS"></a></p> <ul> <li>
<code class="language-plaintext highlighter-rouge">GHC_OPTIONS</code> - List of additional GHC options, which Napkin will pass to the GHC through HLS.</li> </ul> <h2 id="version">Version</h2> <p class="text-delta text-center">shell</p> <div class="language-sh copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code>napkin version <span class="nt">--help</span>
</code></pre></div></div> <div class="highlighter-rouge"><pre>Usage: napkin version 
  Prints Git SHA and version of the build

Available options:
  <a href="#napkin--h,--help">-h,--help</a>                Show this help text

Global options:
  <a href="#napkin--v,--verbose">-v,--verbose</a>             Print debug log
  <a href="#napkin--l,--log-level">-l,--log-level</a> LOG_LEVEL Log severity level. Possible values: Debug, Info,
                           Notice, Warning, Error, Critical, Alert, Emergency.
                           (default: Info)
  <a href="#napkin---log-format">--log-format</a> LOG_FORMAT  Log line format. Possible values: Simple, Server,
                           Json. (default: Simple)
</pre></div> <p>Napkin can print current version, release data and exact git commit on it was built.</p> <p>For example:</p> <p class="text-delta text-center">shell</p> <div class="language-sh copyable highlighter-rouge"><div class="highlight"><pre class="highlight"><code>napkin version
</code></pre></div></div> <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Napkin version: 0.5.11
Git commit hash: a8811868647ccc54e5c716e1a2781fe1c8b2ef9b
Built at: 2022-01-04 10:24:21.398355 UTC
</code></pre></div></div> <p>If you want to install a newer version of Napkin – please, follow <a href="/install/">installation instructions</a>.</p> </div> </div> <div class="search-overlay"></div> </div> <div class="site-super-footer"> <div class="super-nav-box"> <div class="site-logo"></div> <div class="site-buttons"> <div class="table-wrapper"><table> <tr> <td> <a class="link-button active" href="/">Documentation</a> </td> <td> <a class="link-button" href="https://napkinweb.webflow.io/usecases" target="_blank" rel="noopener noreferrer">Use Cases</a> </td> <td> <span class="gradient-border"> <a class="link-button" href="/install/">Get Napkin</a> </span> </td> </tr> <tr> <td> <a class="link-button" href="https://napkinweb.webflow.io/community" target="_blank" rel="noopener noreferrer">Community</a> </td> <td> <a class="link-button" href="https://napkinweb.webflow.io/about" target="_blank" rel="noopener noreferrer">About Napkin</a> </td> </tr> <tr> <td> <a class="link-button" href="https://napkinweb.webflow.io/features" target="_blank" rel="noopener noreferrer">Features</a> </td> <td> <a class="link-button" href="https://napkinweb.webflow.io/contact" target="_blank" rel="noopener noreferrer">Contact</a> </td> </tr> </table></div> </div> <div class="media-bar"> <div class="media-pad"><a href="#" class="inline-icon facebook"></a></div> <div class="media-pad"><a href="#" class="inline-icon twitter"></a></div> <div class="media-pad"><a href="#" class="inline-icon linked-in"></a></div> </div> <div class="copyright"> <div class="left"> Copyright 2022 © </div> <div class="right"> Made with <span class="heart"> </span> in NYC </div> </div> </div> </div> <script type="text/javascript" src="/assets/js/copy.js"></script> </body> </html>
