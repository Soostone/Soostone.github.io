<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Getting Started - Napkin Wiki</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Getting Started | Napkin Wiki</title> <meta name="generator" content="Jekyll v4.2.0" /> <meta property="og:title" content="Getting Started" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Napkin Wiki with howtos and tutorials." /> <meta property="og:description" content="Napkin Wiki with howtos and tutorials." /> <link rel="canonical" href="/getting-started/" /> <meta property="og:url" content="/getting-started/" /> <meta property="og:site_name" content="Napkin Wiki" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Getting Started" /> <script type="application/ld+json"> {"@type":"WebPage","url":"/getting-started/","description":"Napkin Wiki with howtos and tutorials.","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/assets/images/logo-and-name.svg"}},"headline":"Getting Started","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"> <li class="nav-list-item"> <a class="nav-list-link" href="https://napkinweb.webflow.io/"> Napkin product </a> </li><li class="nav-list-item"><a href="/about/" class="nav-list-link">About</a> <ul></ul></li><li class="nav-list-item active"><a href="/getting-started/" class="nav-list-link active">Getting Started</a> <ul><li> <a href="/getting-started/#installation" style="padding-left: 0.2rem;" class="nav-list-link active"> Installation </a> </li><li> <a href="/getting-started/#hello-world" style="padding-left: 0.2rem;" class="nav-list-link active"> Hello world </a> </li></ul></li><li class="nav-list-item"><a href="/tutorial/" class="nav-list-link">Tutorial</a> <ul></ul></li><li class="nav-list-item"><a href="/user-manual/" class="nav-list-link">User Manual</a> <ul></ul></li><li class="nav-list-item"><a href="/haddock/" class="nav-list-link">Haddock</a> <ul></ul></li></ul> </nav> <footer class="site-footer"> <span>Copyright &copy; 2020-2021 <a href="http://soostone.com/" class="black"> <img style="height: 13px; vertical-align: bottom; padding-left: 5px;" src="/assets/images/logo-gem-100.png" /> Soostone </a> </span> </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Napkin Wiki" aria-label="Search Napkin Wiki" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content" role="main"> <h1 id="getting-started"> <a href="#getting-started" class="anchor-heading" aria-labelledby="getting-started"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Getting Started </h1> <h2 id="installation"> <a href="#installation" class="anchor-heading" aria-labelledby="installation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Installation </h2> <p>The <strong>Napkin</strong> app is available in 2 forms: a <a href="#native-installer">native installer</a> and a <a href="#docker-version">dockerized version</a>.</p> <h3 id="native-installer"> <a href="#native-installer" class="anchor-heading" aria-labelledby="native-installer"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Native installer </h3> <p>The Napkin native installer is a self extracting and self contained SHELL archive that does not require a docker or nix environment. It is located in this <a href="https://soostone-napkin-public.s3.us-east-1.amazonaws.com/index.html" target="_blank" rel="noopener">repository</a> and has distributions for the Mac OS Big Sur and Linux operating systems.</p> <p>To use the native installer: 1) Find the distribution corresponding to your operating system 2) Copy the installation snippet 3) Execute it locally As an example, this is the command to install Napkin on MacOS Big Sur:</p> <h4 id="shell" class="top-code-caption"> <a href="#shell" class="anchor-heading" aria-labelledby="shell"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> shell </h4> <div class="language-sh copiable highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-s</span> https://soostone-napkin-public.s3.us-east-1.amazonaws.com/x86_64-MacOS-20.5.0/last-build/napkin-live-installer.sh <span class="se">\</span>
 | bash <span class="nt">-s</span> <span class="nt">--</span>
</code></pre></div></div> <p>The installation bundle is large as it is written in Haskell, a compiled coding language and contains all compiled dependencies. If you need access to the compiler (Glasgow Haskell Compiler <code class="language-plaintext highlighter-rouge">ghci</code>), simply supply the file derivations for the app you are interested in:</p> <h4 id="shell" class="top-code-caption"> <a href="#shell" class="anchor-heading" aria-labelledby="shell"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> shell </h4> <div class="language-sh copiable highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-s</span> https://soostone-napkin-public.s3.us-east-1.amazonaws.com/x86_64-MacOS-20.5.0/last-build/napkin-live-installer.sh <span class="se">\</span>
 | bash <span class="nt">-s</span> <span class="nt">--</span> <span class="nt">-e</span> <span class="s1">'*-ghc-*'</span>
</code></pre></div></div> <p>The ghc derivation contains version <strong>ghci-8.10.4</strong>. Paths to Napkin are imported through the <code class="language-plaintext highlighter-rouge">$PATH</code> variable. When installing Napkin, remember to use a new shell session so you get the updated <code class="language-plaintext highlighter-rouge">$PATH</code> variable. You can also use the <code class="language-plaintext highlighter-rouge">exec $SHELL</code> command.</p> <h4 id="uninstallation"> <a href="#uninstallation" class="anchor-heading" aria-labelledby="uninstallation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Uninstallation </h4> <p>The Napkin native installer contains an uninstaller as well.</p> <p>Type <code class="language-plaintext highlighter-rouge">uninstall-</code> and you can use the ‘tab’ key to auto-complete the uninstallation script.</p> <h4 id="shell" class="top-code-caption"> <a href="#shell" class="anchor-heading" aria-labelledby="shell"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> shell </h4> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>uninstall-
<span class="nv">$ </span>uninstall-b82gj7f0igpw23sapafxifsrr0f52771-napkin-0.3.8.sh
</code></pre></div></div> <h3 id="docker-version"> <a href="#docker-version" class="anchor-heading" aria-labelledby="docker-version"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Docker version </h3> <p>The native installer is not available on <a href="https://en.wikipedia.org/wiki/Microsoft_Windows">Windows</a> yet. There are tutorials on the Internet for setting up <a href="https://nixos.wiki/wiki/Nix">Nix</a> with <a href="https://en.wikipedia.org/wiki/Windows_Subsystem_for_Linux">WSL</a> on Windows.</p> <h2 id="key-features"> <a href="#key-features" class="anchor-heading" aria-labelledby="key-features"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Key Features </h2> <p>Napkin has a robust set of capabilities, with more to come! See our roadmap for more information and to let us know which feature(s) you would like to see added to Napkin the most!</p> <p>One key feature to highlight here is Napkin’s capability to detect unused <a href="https://en.wikipedia.org/wiki/Hierarchical_and_recursive_queries_in_SQL#Common_table_expression">CTE</a> columns. While some table columns are introduced in the SQL pipeline for debugging and development purposes, these can get stale or be forgotten about over time. And more importantly, unused fields are still contributing to pipeline cost and time-to-run.</p> <p>This feature is available via Napkin’s Command Line Interface (CLI). For reference, to see the list of available Napkin commands, type <code class="language-plaintext highlighter-rouge">--help</code>.</p> <h4 id="shell" class="top-code-caption"> <a href="#shell" class="anchor-heading" aria-labelledby="shell"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> shell </h4> <div class="language-sh copiable highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>napkin <span class="nt">--help</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Usage: napkin [-v|--verbose] COMMAND
  Cli tool to work with Napkin
...
  find-unused-cte-columns  Parse SQL file and find unused CTE columns
...
</code></pre></div></div> <p>Detailed help for <code class="language-plaintext highlighter-rouge">find-unused-cte-columns</code> command:</p> <h4 id="shell" class="top-code-caption"> <a href="#shell" class="anchor-heading" aria-labelledby="shell"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> shell </h4> <div class="language-sh copiable highlighter-rouge"><div class="highlight"><pre class="highlight"><code>napkin find-unused-cte-columns <span class="nt">--help</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Usage: napkin find-unused-cte-columns (-b|--backend ARG) (-f|--sql-file ARG)
  Parse SQL file and find unused CTE columns

Available options:
  -b,--backend ARG         choose kind of SQL - BigQueryBackend or
                           PostgresqlBackend
  -f,--sql-file ARG        path to sql file
</code></pre></div></div> <p>Let’s work through an example. First, let’s check the following query for unused columns in an intermediate CTE table within a .sql file:</p> <h4 id="query-sql" class="top-code-caption"> <a href="#query-sql" class="anchor-heading" aria-labelledby="query-sql"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> query.sql </h4> <div class="language-sql copiable highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">WITH</span> <span class="n">CTE</span> <span class="k">AS</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">f</span><span class="p">,</span> <span class="k">g</span> <span class="k">FROM</span> <span class="n">DbTable</span><span class="p">)</span> <span class="k">SELECT</span> <span class="n">f</span> <span class="k">FROM</span> <span class="n">CTE</span>
</code></pre></div></div> <h4 id="shell" class="top-code-caption"> <a href="#shell" class="anchor-heading" aria-labelledby="shell"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> shell </h4> <div class="language-sh copiable highlighter-rouge"><div class="highlight"><pre class="highlight"><code>napkin find-unused-cte-columns <span class="nt">-b</span> PostgresqlBackend <span class="nt">-f</span> query.sql
<span class="o">{</span><span class="s2">"CTE"</span>:[<span class="s2">"g"</span><span class="o">]}</span>
</code></pre></div></div> <p>To deal with a set of SQL files - generate a spec file, sort of a project file:</p> <h4 id="shell" class="top-code-caption"> <a href="#shell" class="anchor-heading" aria-labelledby="shell"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> shell </h4> <div class="language-sh copiable highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cp </span>query.sql query2.sql
<span class="nb">mkdir </span>sql
<span class="nb">mv </span>query.sql query2.sql sql
napkin generate-spec <span class="nt">-d</span> sql <span class="c">#  Generated spec file at: specs/spec.yaml</span>
<span class="nb">cat </span>specs/spec.yaml | <span class="nb">grep source</span> <span class="c"># source: query.sql  source: query2.sql</span>
<span class="nb">mv </span>sql specs <span class="c"># Tiny workaround - might not be needed in the future</span>
napkin optimize
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Table: [query]
query, CTE "CTE" has unused columns ["g"]
Table: [query2]
query2, CTE "CTE" has unused columns ["g"]
</code></pre></div></div> <h2 id="continue-to-the-tutorial-section"> <a href="#continue-to-the-tutorial-section" class="anchor-heading" aria-labelledby="continue-to-the-tutorial-section"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a href="/tutorial">Continue to the Tutorial section…</a> </h2> </div> </div> <div class="search-overlay"></div> </div> <script type="text/javascript" src="/assets/js/copy.js"></script> </body> </html>
